
// Needed to provide ASM_LOAD directive
#include <hal_env.h>

// NOTE
// We use a lot of trivial macros to simplify the parsing burden for Slothy
// The macros are not unfolded by Slothy and thus interpreted as instructions,
// which are easier to parse due to e.g. the lack of size specifiers and simpler
// syntax for pre and post increment for loads and stores.

// Eventually, NeLight should include a proper parser for AArch64,
// but for initial investigations, the below is enough.
xtmp0 .req x10
xtmp1 .req x11

.macro ldr_vo vec, base, offset
       ldr qform_\vec, [\base, #\offset]
.endm

.macro ldr_vi vec, base, inc
        ldr qform_\vec, [\base], #\inc
.endm

.macro str_vo vec, base, offset
        str qform_\vec, [\base, #\offset]
.endm
.macro str_vi vec, base, inc
        str qform_\vec, [\base], #\inc
.endm
.macro vqrdmulh d,a,b
        sqrdmulh \d\().4s, \a\().4s, \b\().4s
.endm
.macro vmls d,a,b
        mls \d\().4s, \a\().4s, \b\().4s
.endm
.macro vqrdmulhq d,a,b,i
        sqrdmulh \d\().4s, \a\().4s, \b\().s[\i]
.endm
.macro vqdmulhq d,a,b,i
        sqdmulh \d\().4s, \a\().4s, \b\().4s[\i]
.endm
.macro vmulq d,a,b,i
        mul \d\().4s, \a\().4s, \b\().s[\i]
.endm
.macro vmlsq d,a,b,i
        mls \d\().4s, \a\().4s, \b\().s[\i]
.endm

.macro mulmodq dst, src, const, idx0, idx1
        vmulq       \dst,  \src, \const, \idx0
        vqrdmulhq   \src,  \src, \const, \idx1
        vmlsq        \dst,  \src, consts, 0
.endm

.macro mulmod dst, src, const, const_twisted
        mul        \dst\().4s,  \src\().4s, \const\().4s
        vqrdmulh   \src,  \src, \const_twisted
        vmlsq       \dst,  \src, consts, 0
.endm

.macro ct_butterfly a, b, root, idx0, idx1
        mulmodq  tmp, \b, \root, \idx0, \idx1
        sub     \b\().4s,    \a\().4s, tmp.4s
        add     \a\().4s,    \a\().4s, tmp.4s
.endm

.macro mulmod_v dst, src, const, const_twisted
        mul        \dst\().4s,  \src\().4s, \const\().4s
        vqrdmulh    \src,  \src, \const_twisted
        vmlsq        \dst,  \src, consts, 0
.endm

.macro ct_butterfly_v a, b, root, root_twisted
        mulmod  tmp, \b, \root, \root_twisted
        sub    \b\().4s,    \a\().4s, tmp.4s
        add    \a\().4s,    \a\().4s, tmp.4s
.endm

.macro barrett_reduce_single a
        srshr    tmp.4S, \a\().4S, #23
        vmlsq    \a, tmp, consts, 0
.endm

.macro barrett_reduce a0, a1, a2, a3
        barrett_reduce_single \a0
        barrett_reduce_single \a1
        barrett_reduce_single \a2
        barrett_reduce_single \a3
.endm

.macro load_vectors a0, a1, a2, a3, addr
        ldr_vo \a0, \addr, (16*0)
        ldr_vo \a1, \addr, (16*1)
        ldr_vo \a2, \addr, (16*2)
        ldr_vo \a3, \addr, (16*3)
.endm

.macro load_vectors_with_offset a0, a1, a2, a3, addr, offset
        ldr_vo \a0, \addr, (16*0 + (\offset))
        ldr_vo \a1, \addr, (16*1 + (\offset))
        ldr_vo \a2, \addr, (16*2 + (\offset))
        ldr_vo \a3, \addr, (16*3 + (\offset))
.endm

.macro store_vectors_with_inc a0, a1, a2, a3, addr, inc
        str_vi \a0, \addr, \inc
        str_vo \a1, \addr, (-(\inc) + 16*1)
        str_vo \a2, \addr, (-(\inc) + 16*2)
        str_vo \a3, \addr, (-(\inc) + 16*3)
.endm

.macro vec_to_scalar_matrix out, in
        vext \out\()_00, \in\()0, 0
        vext \out\()_01, \in\()0, 1
        vext \out\()_10, \in\()1, 0
        vext \out\()_11, \in\()1, 1
        vext \out\()_20, \in\()2, 0
        vext \out\()_21, \in\()2, 1
        vext \out\()_30, \in\()3, 0
        vext \out\()_31, \in\()3, 1
.endm

.macro store_scalar_matrix_with_inc x, addr, inc
        str \x\()t_00, [\addr], #( \inc)
        str \x\()t_01, [\addr,  #(-\inc + 8*1)]
        str \x\()t_10, [\addr,  #(-\inc + 8*2)]
        str \x\()t_11, [\addr,  #(-\inc + 8*3)]
        str \x\()t_20, [\addr,  #(-\inc + 8*4)]
        str \x\()t_21, [\addr,  #(-\inc + 8*5)]
        str \x\()t_30, [\addr,  #(-\inc + 8*6)]
        str \x\()t_31, [\addr,  #(-\inc + 8*7)]
.endm

.macro vext gpr_out, vec_in, lane
        umov \gpr_out\(), \vec_in\().d[\lane]
.endm

.macro load_roots_123
        ldr_vi root0, r_ptr0, 64
        ldr_vo root1, r_ptr0, (-64 + 16)
        ldr_vo root2, r_ptr0, (-64 + 32)
        ldr_vo root3, r_ptr0, (-64 + 48)
.endm

.macro load_roots_456
        ldr_vi root0, r_ptr0, 64
        ldr_vo root1, r_ptr0, (-64 + 16)
        ldr_vo root2, r_ptr0, (-64 + 32)
        ldr_vo root3, r_ptr0, (-64 + 48)
.endm

.macro load_roots_78_part1
        ldr_vi root0,    r_ptr1, (12*16)
        ldr_vo root0_tw, r_ptr1, (-12*16 + 1*16)
        ldr_vo root1,    r_ptr1, (-12*16 + 2*16)
        ldr_vo root1_tw, r_ptr1, (-12*16 + 3*16)
        ldr_vo root2,    r_ptr1, (-12*16 + 4*16)
        ldr_vo root2_tw, r_ptr1, (-12*16 + 5*16)
.endm

.macro load_roots_78_part2
        ldr_vo root0,    r_ptr1, (-12*16 +  6*16)
        ldr_vo root0_tw, r_ptr1, (-12*16 +  7*16)
        ldr_vo root1,    r_ptr1, (-12*16 +  8*16)
        ldr_vo root1_tw, r_ptr1, (-12*16 +  9*16)
        ldr_vo root2,    r_ptr1, (-12*16 + 10*16)
        ldr_vo root2_tw, r_ptr1, (-12*16 + 11*16)
.endm

.macro transpose4 data0, data1, data2, data3
        trn1 t0.4s, \data0\().4s, \data1\().4s
        trn2 t1.4s, \data0\().4s, \data1\().4s
        trn1 t2.4s, \data2\().4s, \data3\().4s
        trn2 t3.4s, \data2\().4s, \data3\().4s

        trn2 \data2\().2d, t0.2d, t2.2d
        trn2 \data3\().2d, t1.2d, t3.2d
        trn1 \data0\().2d, t0.2d, t2.2d
        trn1 \data1\().2d, t1.2d, t3.2d
.endm

.macro transpose_single data_out0, data_out1, data_out2, data_out3, data_in0,  data_in1,  data_in2,  data_in3
        trn1 \data_out0\().4s, \data_in0\().4s, \data_in1\().4s
        trn2 \data_out1\().4s, \data_in0\().4s, \data_in1\().4s
        trn1 \data_out2\().4s, \data_in2\().4s, \data_in3\().4s
        trn2 \data_out3\().4s, \data_in2\().4s, \data_in3\().4s
.endm

.macro save_gprs // slothy:no-unfold
        sub sp, sp, #(16*6)
        stp x19, x20, [sp, #16*0]
        stp x19, x20, [sp, #16*0]
        stp x21, x22, [sp, #16*1]
        stp x23, x24, [sp, #16*2]
        stp x25, x26, [sp, #16*3]
        stp x27, x28, [sp, #16*4]
        stp x29, x30, [sp, #16*5]
.endm

.macro restore_gprs // slothy:no-unfold
        ldp x19, x20, [sp, #16*0]
        ldp x21, x22, [sp, #16*1]
        ldp x23, x24, [sp, #16*2]
        ldp x25, x26, [sp, #16*3]
        ldp x27, x28, [sp, #16*4]
        ldp x29, x30, [sp, #16*5]
        add sp, sp, #(16*6)
.endm

.macro save_vregs // slothy:no-unfold
        sub sp, sp, #(16*4)
        stp  d8,  d9, [sp, #16*0]
        stp d10, d11, [sp, #16*1]
        stp d12, d13, [sp, #16*2]
        stp d14, d15, [sp, #16*3]
.endm

.macro restore_vregs // slothy:no-unfold
        ldp  d8,  d9, [sp, #16*0]
        ldp d10, d11, [sp, #16*1]
        ldp d12, d13, [sp, #16*2]
        ldp d14, d15, [sp, #16*3]
        add sp, sp, #(16*4)
.endm

#define STACK_SIZE 16
#define STACK0 0

.macro restore a, loc     // slothy:no-unfold
        ldr \a, [sp, #\loc\()]
.endm
.macro save loc, a        // slothy:no-unfold
        str \a, [sp, #\loc\()]
.endm
.macro push_stack // slothy:no-unfold
        save_gprs
        save_vregs
        sub sp, sp, #STACK_SIZE
.endm

.macro pop_stack // slothy:no-unfold
        add sp, sp, #STACK_SIZE
        restore_vregs
        restore_gprs
.endm

.data
.p2align 4
roots:
#include "ntt_dilithium_123_456_78_twiddles.s"
.text

        .global ntt_dilithium_123_45678_manual_st4_opt_m1_icestorm
        .global _ntt_dilithium_123_45678_manual_st4_opt_m1_icestorm

.p2align 4
const_addr:   .word 8380417
              .word 0
              .word 0
              .word 0

ntt_dilithium_123_45678_manual_st4_opt_m1_icestorm:
_ntt_dilithium_123_45678_manual_st4_opt_m1_icestorm:
        push_stack

        in      .req x0
        inp     .req x1
        inpp    .req x2
        count   .req x3
        r_ptr0  .req x4
        r_ptr1  .req x5
        xtmp    .req x6

        data0  .req v9
        data1  .req v10
        data2  .req v11
        data3  .req v12
        data4  .req v13
        data5  .req v14
        data6  .req v15
        data7  .req v16

        qform_data0  .req q9
        qform_data1  .req q10
        qform_data2  .req q11
        qform_data3  .req q12
        qform_data4  .req q13
        qform_data5  .req q14
        qform_data6  .req q15
        qform_data7  .req q16

        qform_v0  .req q0
        qform_v1  .req q1
        qform_v2  .req q2
        qform_v3  .req q3
        qform_v4  .req q4
        qform_v5  .req q5
        qform_v6  .req q6
        qform_v7  .req q7
        qform_v8  .req q8
        qform_v9  .req q9
        qform_v10 .req q10
        qform_v11 .req q11
        qform_v12 .req q12
        qform_v13 .req q13
        qform_v14 .req q14
        qform_v15 .req q15
        qform_v16 .req q16
        qform_v17 .req q17
        qform_v18 .req q18
        qform_v19 .req q19
        qform_v20 .req q20
        qform_v21 .req q21
        qform_v22 .req q22
        qform_v23 .req q23
        qform_v24 .req q24
        qform_v25 .req q25
        qform_v26 .req q26
        qform_v27 .req q27
        qform_v28 .req q28
        qform_v29 .req q29
        qform_v30 .req q30
        qform_v31 .req q31

        x_00 .req x10
        x_01 .req x11
        x_10 .req x12
        x_11 .req x13
        x_20 .req x14
        x_21 .req x15
        x_30 .req x16
        x_31 .req x17

        xt_00 .req x_00
        xt_01 .req x_20
        xt_10 .req x_10
        xt_11 .req x_30
        xt_20 .req x_01
        xt_21 .req x_21
        xt_30 .req x_11
        xt_31 .req x_31

        root0 .req v0
        root1 .req v1
        root2 .req v2
        root3 .req v3

        qform_root0 .req q0
        qform_root1 .req q1
        qform_root2 .req q2
        qform_root3 .req q3

        tmp .req v24
        t0  .req v25
        t1  .req v26
        t2  .req v27
        t3  .req v28
        tp0 .req v17
        tp1 .req v18
        tp2 .req v19
        tp3 .req v20

        consts .req v8
        qform_consts .req q8

        ASM_LOAD(r_ptr0, roots_l012)
        ASM_LOAD(r_ptr1, roots_l67)

        ASM_LOAD(xtmp, const_addr)
        ld1r {consts.4s}, [xtmp]

        save STACK0, in
        mov count, #8

        load_roots_123

        .p2align 2
        ldr q16, [x0, #384]                     // .*...........................................
        // gap                                  // .............................................
        ldr q21, [x0, #896]                     // ..*..........................................
        // gap                                  // .............................................
        ldr q10, [x0, #0]                       // ...........*.................................
        ldr q29, [x0, #768]                     // ...*.........................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        ldr q25, [x0, #640]                     // ......*......................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        ldr q7, [x0, #512]                      // *............................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mul v4.4S, v21.4S, v0.S[0]              // .......*.....................................
        sqrdmulh v13.4S, v21.4S, v0.S[1]        // ........*....................................
        ldr q9, [x0, #256]                      // ..............*..............................
        // gap                                  // .............................................
        sqrdmulh v24.4S, v29.4S, v0.S[1]        // .........*...................................
        mul v6.4S, v29.4S, v0.S[0]              // ................*............................
        ldr q29, [x0, #128]                     // ....................*........................
        // gap                                  // .............................................
        sqrdmulh v21.4S, v25.4S, v0.S[1]        // .............*...............................
        mul v30.4S, v25.4S, v0.S[0]             // ...............*.............................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mls v4.4S, v13.4S, v8.S[0]              // ............*................................
        sqrdmulh v18.4S, v7.4S, v0.S[1]         // .....*.......................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mul v7.4S, v7.4S, v0.S[0]               // ....*........................................
        mls v6.4S, v24.4S, v8.S[0]              // .....................*.......................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mls v30.4S, v21.4S, v8.S[0]             // ...................*.........................
        // gap                                  // .............................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        sub v12.4S, v16.4S, v4.4S               // .....................................*.......
        add v4.4S, v16.4S, v4.4S                // .................*...........................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mls v7.4S, v18.4S, v8.S[0]              // ..........*..................................
        add v25.4S, v9.4S, v6.4S                // ..........................*..................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mul v15.4S, v4.4S, v0.S[2]              // ......................*......................
        sqrdmulh v21.4S, v4.4S, v0.S[3]         // .......................*.....................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mul v4.4S, v25.4S, v0.S[2]              // ..............................*..............
        sub v5.4S, v29.4S, v30.4S               // ...........................................*.
        // gap                                  // .............................................
        // gap                                  // .............................................
        sqrdmulh v16.4S, v25.4S, v0.S[3]        // .................................*...........
        sub v19.4S, v10.4S, v7.4S               // ..................*..........................
        // gap                                  // .............................................
        // gap                                  // .............................................
        add v17.4S, v10.4S, v7.4S               // .........................................*...
        mls v15.4S, v21.4S, v8.S[0]             // ...........................*.................
        // gap                                  // .............................................
        // gap                                  // .............................................
        add v10.4S, v29.4S, v30.4S              // ........................*....................
        sub v29.4S, v9.4S, v6.4S                // .........................*...................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mls v4.4S, v16.4S, v8.S[0]              // .......................................*.....
        // gap                                  // .............................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        sub v16.4S, v10.4S, v15.4S              // ................................*............
        mul v9.4S, v29.4S, v1.S[0]              // ............................*................
        // gap                                  // .............................................
        // gap                                  // .............................................
        sqrdmulh v14.4S, v29.4S, v1.S[1]        // .............................*...............
        add v29.4S, v10.4S, v15.4S              // ...............................*.............
        // gap                                  // .............................................
        // gap                                  // .............................................
        mul v21.4S, v16.4S, v2.S[0]             // ....................................*........
        sqrdmulh v16.4S, v16.4S, v2.S[1]        // ...................................*.........
        // gap                                  // .............................................
        // gap                                  // .............................................
        mul v30.4S, v29.4S, v1.S[2]             // ......................................*......
        // gap                                  // .............................................
        // gap                                  // .............................................
        // gap                                  // .............................................
        mls v9.4S, v14.4S, v8.S[0]              // ..................................*..........
        sqrdmulh v20.4S, v29.4S, v1.S[3]        // ........................................*....
        // gap                                  // .............................................
        // gap                                  // .............................................
        mls v21.4S, v16.4S, v8.S[0]             // ..........................................*..
        mul v16.4S, v12.4S, v1.S[0]             // ............................................*
        // gap                                  // .............................................
        // gap                                  // .............................................

        // original source code
        // ldr q20, [x0, #512]                   // .....*.......................................
        // ldr q24, [x0, #384]                   // *............................................
        // ldr q12, [x0, #896]                   // .*...........................................
        // ldr q4, [x0, #768]                    // ...*.........................................
        // mul v10.4S, v20.4S, v0.S[0]           // ................*............................
        // sqrdmulh v9.4S, v20.4S, v0.S[1]       // ...............*.............................
        // ldr q17, [x0, #640]                   // ....*........................................
        // mul v29.4S, v12.4S, v0.S[0]           // ......*......................................
        // sqrdmulh v26.4S, v12.4S, v0.S[1]      // .......*.....................................
        // sqrdmulh v6.4S, v4.4S, v0.S[1]        // .........*...................................
        // mls v10.4S, v9.4S, v8.S[0]            // .....................*.......................
        // ldr q27, [x0, #0]                     // ..*..........................................
        // mls v29.4S, v26.4S, v8.S[0]           // ..............*..............................
        // sqrdmulh v9.4S, v17.4S, v0.S[1]       // ............*................................
        // ldr q23, [x0, #256]                   // ........*....................................
        // mul v16.4S, v17.4S, v0.S[0]           // .............*...............................
        // mul v4.4S, v4.4S, v0.S[0]             // ..........*..................................
        // add v26.4S, v24.4S, v29.4S            // ....................*........................
        // sub v19.4S, v27.4S, v10.4S            // ............................*................
        // mls v16.4S, v9.4S, v8.S[0]            // ..................*..........................
        // ldr q28, [x0, #128]                   // ...........*.................................
        // mls v4.4S, v6.4S, v8.S[0]             // .................*...........................
        // mul v15.4S, v26.4S, v0.S[2]           // .......................*.....................
        // sqrdmulh v12.4S, v26.4S, v0.S[3]      // ........................*....................
        // add v14.4S, v28.4S, v16.4S            // ...............................*.............
        // sub v30.4S, v23.4S, v4.4S             // ................................*............
        // add v23.4S, v23.4S, v4.4S             // ......................*......................
        // mls v15.4S, v12.4S, v8.S[0]           // ..............................*..............
        // mul v9.4S, v30.4S, v1.S[0]            // ...................................*.........
        // sqrdmulh v12.4S, v30.4S, v1.S[1]      // ....................................*........
        // mul v4.4S, v23.4S, v0.S[2]            // .........................*...................
        // add v18.4S, v14.4S, v15.4S            // .....................................*.......
        // sub v30.4S, v14.4S, v15.4S            // ..................................*..........
        // sqrdmulh v20.4S, v23.4S, v0.S[3]      // ...........................*.................
        // mls v9.4S, v12.4S, v8.S[0]            // .........................................*...
        // sqrdmulh v11.4S, v30.4S, v2.S[1]      // .......................................*.....
        // mul v21.4S, v30.4S, v2.S[0]           // ......................................*......
        // sub v12.4S, v24.4S, v29.4S            // ...................*.........................
        // mul v30.4S, v18.4S, v1.S[2]           // ........................................*....
        // mls v4.4S, v20.4S, v8.S[0]            // .................................*...........
        // sqrdmulh v20.4S, v18.4S, v1.S[3]      // ..........................................*..
        // add v17.4S, v27.4S, v10.4S            // .............................*...............
        // mls v21.4S, v11.4S, v8.S[0]           // ...........................................*.
        // sub v5.4S, v28.4S, v16.4S             // ..........................*..................
        // mul v16.4S, v12.4S, v1.S[0]           // ............................................*

        sub count, count, #1
layer123_start:
        mls v30.4S, v20.4S, v8.S[0]             // ..................................................*.........................
        ldr q20, [x0, #528]                     // ....e.......................................................................
        ldr q24, [x0, #400]                     // ...e........................................................................
        sqrdmulh v28.4S, v12.4S, v1.S[1]        // ............................................*...............................
        add v18.4S, v19.4S, v9.4S               // ..........................................*.................................
        // gap                                  // ............................................................................
        add v11.4S, v17.4S, v4.4S               // ................................*...........................................
        ldr q12, [x0, #912]                     // .......e....................................................................
        sub v31.4S, v17.4S, v4.4S               // ...............................*............................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        sub v7.4S, v19.4S, v9.4S                // .........................................*..................................
        mls v16.4S, v28.4S, v8.S[0]             // .............................................*..............................
        sub v22.4S, v11.4S, v30.4S              // ...................................................*........................
        // gap                                  // ............................................................................
        ldr q4, [x0, #784]                      // ......e.....................................................................
        mul v10.4S, v20.4S, v0.S[0]             // ........e...................................................................
        sqrdmulh v9.4S, v20.4S, v0.S[1]         // .........e..................................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        ldr q17, [x0, #656]                     // .....e......................................................................
        mul v29.4S, v12.4S, v0.S[0]             // .......................e....................................................
        sqrdmulh v26.4S, v12.4S, v0.S[1]        // ........................e...................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        sub v20.4S, v5.4S, v16.4S               // ..............................................*.............................
        add v5.4S, v5.4S, v16.4S                // ...............................................*............................
        // gap                                  // ............................................................................
        sqrdmulh v6.4S, v4.4S, v0.S[1]          // ...................e........................................................
        mls v10.4S, v9.4S, v8.S[0]              // ..........e.................................................................
        ldr q27, [x0, #16]                      // e...........................................................................
        // gap                                  // ............................................................................
        sqrdmulh v28.4S, v20.4S, v3.S[1]        // ................................................................*...........
        mul v15.4S, v20.4S, v3.S[0]             // ...............................................................*............
        // gap                                  // ............................................................................
        mls v29.4S, v26.4S, v8.S[0]             // .........................e..................................................
        // gap                                  // ............................................................................
        sqrdmulh v9.4S, v17.4S, v0.S[1]         // ..............e.............................................................
        ldr q23, [x0, #272]                     // ..e.........................................................................
        mul v20.4S, v5.4S, v2.S[2]              // ..........................................................*.................
        // gap                                  // ............................................................................
        mul v16.4S, v17.4S, v0.S[0]             // .............e..............................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        mls v15.4S, v28.4S, v8.S[0]             // .................................................................*..........
        mul v4.4S, v4.4S, v0.S[0]               // ..................e.........................................................
        // gap                                  // ............................................................................
        add v26.4S, v24.4S, v29.4S              // ...........................e................................................
        // gap                                  // ............................................................................
        sub v19.4S, v27.4S, v10.4S              // ...........e................................................................
        // gap                                  // ............................................................................
        mls v16.4S, v9.4S, v8.S[0]              // ...............e............................................................
        sqrdmulh v13.4S, v5.4S, v2.S[3]         // ...........................................................*................
        ldr q28, [x0, #144]                     // .e..........................................................................
        sub v17.4S, v7.4S, v15.4S               // ..................................................................*.........
        add v9.4S, v7.4S, v15.4S                // ...................................................................*........
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        mls v4.4S, v6.4S, v8.S[0]               // ....................e.......................................................
        mul v15.4S, v26.4S, v0.S[2]             // .................................e..........................................
        mls v20.4S, v13.4S, v8.S[0]             // ............................................................*...............
        str q9, [x0, #768]                      // ..........................................................................*.
        // gap                                  // ............................................................................
        sqrdmulh v12.4S, v26.4S, v0.S[3]        // ..................................e.........................................
        add v7.4S, v11.4S, v30.4S               // ....................................................*.......................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        add v14.4S, v28.4S, v16.4S              // .................e..........................................................
        sub v30.4S, v23.4S, v4.4S               // .....................e......................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        add v23.4S, v23.4S, v4.4S               // ......................e.....................................................
        add v13.4S, v18.4S, v20.4S              // ..............................................................*.............
        mls v15.4S, v12.4S, v8.S[0]             // ...................................e........................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        mul v9.4S, v30.4S, v1.S[0]              // ......................................e.....................................
        sqrdmulh v12.4S, v30.4S, v1.S[1]        // .......................................e....................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        sub v11.4S, v18.4S, v20.4S              // .............................................................*..............
        // gap                                  // ............................................................................
        mul v4.4S, v23.4S, v0.S[2]              // ............................e...............................................
        // gap                                  // ............................................................................
        // gap                                  // ............................................................................
        add v18.4S, v14.4S, v15.4S              // .....................................e......................................
        sub v30.4S, v14.4S, v15.4S              // ....................................e.......................................
        sqrdmulh v20.4S, v23.4S, v0.S[3]        // .............................e..............................................
        mls v9.4S, v12.4S, v8.S[0]              // ........................................e...................................
        // gap                                  // ............................................................................
        str q11, [x0, #640]                     // .........................................................................*..
        sqrdmulh v11.4S, v30.4S, v2.S[1]        // ......................................................e.....................
        // gap                                  // ............................................................................
        sub v23.4S, v31.4S, v21.4S              // ........................................................*...................
        str q13, [x0, #512]                     // ........................................................................*...
        // gap                                  // ............................................................................
        str q17, [x0, #896]                     // ...........................................................................*
        add v15.4S, v31.4S, v21.4S              // .........................................................*..................
        mul v21.4S, v30.4S, v2.S[0]             // .....................................................e......................
        sub v12.4S, v24.4S, v29.4S              // ..........................e.................................................
        mul v30.4S, v18.4S, v1.S[2]             // ................................................e...........................
        // gap                                  // ............................................................................
        str q7, [x0], #(16)                     // ....................................................................*.......
        mls v4.4S, v20.4S, v8.S[0]              // ..............................e.............................................
        // gap                                  // ............................................................................
        sqrdmulh v20.4S, v18.4S, v1.S[3]        // .................................................e..........................
        str q22, [x0, #112]                     // .....................................................................*......
        add v17.4S, v27.4S, v10.4S              // ............e...............................................................
        // gap                                  // ............................................................................
        mls v21.4S, v11.4S, v8.S[0]             // .......................................................e....................
        str q15, [x0, #240]                     // ......................................................................*.....
        // gap                                  // ............................................................................
        sub v5.4S, v28.4S, v16.4S               // ................e...........................................................
        str q23, [x0, #368]                     // .......................................................................*....
        mul v16.4S, v12.4S, v1.S[0]             // ...........................................e................................

        // original source code
        // ldr q9, [x0, #0]                        // ....................e......................................................|....................e.....................................................
        // ldr q10, [x0, #(1*(1024/8))]            // ..................................e........................................|..................................e.......................................
        // ldr q11, [x0, #(2*(1024/8))]            // .........................e.................................................|.........................e................................................
        // ldr q12, [x0, #(3*(1024/8))]            // .e.........................................................................|.e........................................................................
        // ldr q13, [x0, #(4*(1024/8))]            // e..........................................................................|e.........................................................................
        // ldr q14, [x0, #(5*(1024/8))]            // .............e.............................................................|.............e............................................................
        // ldr q15, [x0, #(6*(1024/8))]            // ..........e................................................................|..........e...............................................................
        // ldr q16, [x0, #(7*(1024/8))]            // .....e.....................................................................|.....e....................................................................
        // mul v24.4s, v13.4s, v0.s[0]             // ...........e...............................................................|...........e..............................................................
        // sqrdmulh v13.4s, v13.4s, v0.s[1]        // ............e..............................................................|............e.............................................................
        // mls v24.4s, v13.4s, v8.s[0]             // ...................e.......................................................|...................e......................................................
        // sub     v13.4s,    v9.4s, v24.4s        // ...............................e...........................................|...............................e..........................................
        // add     v9.4s,    v9.4s, v24.4s         // .....................................................................e.....|.....................................................................e....
        // mul v24.4s, v14.4s, v0.s[0]             // ...........................e...............................................|...........................e..............................................
        // sqrdmulh v14.4s, v14.4s, v0.s[1]        // ........................e..................................................|........................e.................................................
        // mls v24.4s, v14.4s, v8.s[0]             // ................................e..........................................|................................e.........................................
        // sub     v14.4s,    v10.4s, v24.4s       // ........................................................................e..|........................................................................e.
        // add     v10.4s,    v10.4s, v24.4s       // ...........................................e...............................|...........................................e..............................
        // mul v24.4s, v15.4s, v0.s[0]             // .............................e.............................................|.............................e............................................
        // sqrdmulh v15.4s, v15.4s, v0.s[1]        // ..................e........................................................|..................e.......................................................
        // mls v24.4s, v15.4s, v8.s[0]             // .....................................e.....................................|.....................................e....................................
        // sub     v15.4s,    v11.4s, v24.4s       // ............................................e..............................|............................................e.............................
        // add     v11.4s,    v11.4s, v24.4s       // .............................................e.............................|.............................................e............................
        // mul v24.4s, v16.4s, v0.s[0]             // ..............e............................................................|..............e...........................................................
        // sqrdmulh v16.4s, v16.4s, v0.s[1]        // ...............e...........................................................|...............e..........................................................
        // mls v24.4s, v16.4s, v8.s[0]             // .......................e...................................................|.......................e..................................................
        // sub     v16.4s,    v12.4s, v24.4s       // ...............................................................e...........|...............................................................e..........
        // add     v12.4s,    v12.4s, v24.4s       // ..............................e............................................|..............................e...........................................
        // mul v24.4s, v11.4s, v0.s[2]             // ...................................................e.......................|...................................................e......................
        // sqrdmulh v11.4s, v11.4s, v0.s[3]        // ......................................................e....................|......................................................e...................
        // mls v24.4s, v11.4s, v8.s[0]             // ..................................................................e........|..................................................................e.......
        // sub     v11.4s,    v9.4s, v24.4s        // ......*....................................................................|......*...................................................................
        // add     v9.4s,    v9.4s, v24.4s         // ....*......................................................................|....*.....................................................................
        // mul v24.4s, v12.4s, v0.s[2]             // ......................................e....................................|......................................e...................................
        // sqrdmulh v12.4s, v12.4s, v0.s[3]        // .........................................e.................................|.........................................e................................
        // mls v24.4s, v12.4s, v8.s[0]             // ...............................................e...........................|...............................................e..........................
        // sub     v12.4s,    v10.4s, v24.4s       // .....................................................e.....................|.....................................................e....................
        // add     v10.4s,    v10.4s, v24.4s       // ....................................................e......................|....................................................e.....................
        // mul v24.4s, v15.4s, v1.s[0]             // ................................................e..........................|................................................e.........................
        // sqrdmulh v15.4s, v15.4s, v1.s[1]        // .................................................e.........................|.................................................e........................
        // mls v24.4s, v15.4s, v8.s[0]             // .......................................................e...................|.......................................................e..................
        // sub     v15.4s,    v13.4s, v24.4s       // .......*...................................................................|.......*..................................................................
        // add     v13.4s,    v13.4s, v24.4s       // ...*.......................................................................|...*......................................................................
        // mul v24.4s, v16.4s, v1.s[0]             // ..........................................................................e|..........................................................................
        // sqrdmulh v16.4s, v16.4s, v1.s[1]        // ..*........................................................................|..*.......................................................................
        // mls v24.4s, v16.4s, v8.s[0]             // ........*..................................................................|........*.................................................................
        // sub     v16.4s,    v14.4s, v24.4s       // ................*..........................................................|................*.........................................................
        // add     v14.4s,    v14.4s, v24.4s       // .................*.........................................................|.................*........................................................
        // mul v24.4s, v10.4s, v1.s[2]             // ................................................................e..........|................................................................e.........
        // sqrdmulh v10.4s, v10.4s, v1.s[3]        // ...................................................................e.......|...................................................................e......
        // mls v24.4s, v10.4s, v8.s[0]             // ...........................................................................*..........................................................................
        // sub     v10.4s,    v9.4s, v24.4s        // .........*.................................................................|.........*................................................................
        // add     v9.4s,    v9.4s, v24.4s         // ..........................................*................................|..........................................*...............................
        // mul v24.4s, v12.4s, v2.s[0]             // ..............................................................e............|..............................................................e...........
        // sqrdmulh v12.4s, v12.4s, v2.s[1]        // .........................................................e.................|.........................................................e................
        // mls v24.4s, v12.4s, v8.s[0]             // ......................................................................e....|......................................................................e...
        // sub     v12.4s,    v11.4s, v24.4s       // ..........................................................*................|..........................................................*...............
        // add     v11.4s,    v11.4s, v24.4s       // .............................................................*.............|.............................................................*............
        // mul v24.4s, v14.4s, v2.s[2]             // ..........................*................................................|..........................*...............................................
        // sqrdmulh v14.4s, v14.4s, v2.s[3]        // .................................*.........................................|.................................*........................................
        // mls v24.4s, v14.4s, v8.s[0]             // .......................................*...................................|.......................................*..................................
        // sub     v14.4s,    v13.4s, v24.4s       // ..................................................*........................|..................................................*.......................
        // add     v13.4s,    v13.4s, v24.4s       // ..............................................*............................|..............................................*...........................
        // mul v24.4s, v16.4s, v3.s[0]             // ......................*....................................................|......................*...................................................
        // sqrdmulh v16.4s, v16.4s, v3.s[1]        // .....................*.....................................................|.....................*....................................................
        // mls v24.4s, v16.4s, v8.s[0]             // ............................*..............................................|............................*.............................................
        // sub     v16.4s,    v15.4s, v24.4s       // ...................................*.......................................|...................................*......................................
        // add     v15.4s,    v15.4s, v24.4s       // ....................................*......................................|....................................*.....................................
        // str q9, [x0], #(16)                     // .................................................................*.........|.................................................................*........
        // str q10, [x0, #(-16 + 1*(1024/8))]      // ....................................................................*......|....................................................................*.....
        // str q11, [x0, #(-16 + 2*(1024/8))]      // .......................................................................*...|.......................................................................*..
        // str q12, [x0, #(-16 + 3*(1024/8))]      // .........................................................................*.|.........................................................................*
        // str q13, [x0, #(-16 + 4*(1024/8))]      // ...........................................................*...............|...........................................................*..............
        // str q14, [x0, #(-16 + 5*(1024/8))]      // ........................................................*..................|........................................................*.................
        // str q15, [x0, #(-16 + 6*(1024/8))]      // ........................................*..................................|........................................*.................................
        // str q16, [x0, #(-16 + 7*(1024/8))]      // ............................................................*..............|............................................................*.............

        sub count, count, #1
        cbnz count, layer123_start
        sub v6.4S, v17.4S, v4.4S                // ....*..........................
        sqrdmulh v28.4S, v12.4S, v1.S[1]        // .*.............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        mls v30.4S, v20.4S, v8.S[0]             // *..............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        add v11.4S, v6.4S, v21.4S               // ..........................*....
        sub v10.4S, v6.4S, v21.4S               // .......................*.......
        // gap                                  // ...............................
        // gap                                  // ...............................
        mls v16.4S, v28.4S, v8.S[0]             // ......*........................
        add v6.4S, v17.4S, v4.4S                // ...*...........................
        // gap                                  // ...............................
        // gap                                  // ...............................
        add v28.4S, v19.4S, v9.4S               // ..*............................
        str q11, [x0, #256]                     // .............................*.
        // gap                                  // ...............................
        // gap                                  // ...............................
        str q10, [x0, #384]                     // ..............................*
        add v22.4S, v6.4S, v30.4S               // ...................*...........
        // gap                                  // ...............................
        // gap                                  // ...............................
        sub v14.4S, v5.4S, v16.4S               // ........*......................
        add v16.4S, v5.4S, v16.4S               // .........*.....................
        // gap                                  // ...............................
        // gap                                  // ...............................
        sub v5.4S, v19.4S, v9.4S                // .....*.........................
        sub v30.4S, v6.4S, v30.4S               // .......*.......................
        str q22, [x0], #(16)                    // ...........................*...
        // gap                                  // ...............................
        sqrdmulh v19.4S, v14.4S, v3.S[1]        // ..........*....................
        mul v6.4S, v14.4S, v3.S[0]              // ...........*...................
        // gap                                  // ...............................
        // gap                                  // ...............................
        str q30, [x0, #112]                     // ............................*..
        mul v10.4S, v16.4S, v2.S[2]             // ............*..................
        // gap                                  // ...............................
        // gap                                  // ...............................
        sqrdmulh v30.4S, v16.4S, v2.S[3]        // ..............*................
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        mls v6.4S, v19.4S, v8.S[0]              // .............*.................
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        mls v10.4S, v30.4S, v8.S[0]             // .................*.............
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        sub v27.4S, v5.4S, v6.4S                // ...............*...............
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        add v5.4S, v5.4S, v6.4S                 // ................*..............
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        sub v16.4S, v28.4S, v10.4S              // .....................*.........
        add v9.4S, v28.4S, v10.4S               // ....................*..........
        str q27, [x0, #880]                     // .........................*.....
        // gap                                  // ...............................
        str q5, [x0, #752]                      // ..................*............
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        str q16, [x0, #624]                     // ......................*........
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................
        str q9, [x0, #496]                      // ........................*......
        // gap                                  // ...............................
        // gap                                  // ...............................
        // gap                                  // ...............................

        // original source code
        // mls v30.4S, v20.4S, v8.S[0]           // ..*............................
        // sqrdmulh v28.4S, v12.4S, v1.S[1]      // .*.............................
        // add v18.4S, v19.4S, v9.4S             // .......*.......................
        // add v11.4S, v17.4S, v4.4S             // ......*........................
        // sub v31.4S, v17.4S, v4.4S             // *..............................
        // sub v7.4S, v19.4S, v9.4S              // .............*.................
        // mls v16.4S, v28.4S, v8.S[0]           // .....*.........................
        // sub v22.4S, v11.4S, v30.4S            // ..............*................
        // sub v20.4S, v5.4S, v16.4S             // ...........*...................
        // add v5.4S, v5.4S, v16.4S              // ............*..................
        // sqrdmulh v28.4S, v20.4S, v3.S[1]      // ................*..............
        // mul v15.4S, v20.4S, v3.S[0]           // .................*.............
        // mul v20.4S, v5.4S, v2.S[2]            // ...................*...........
        // mls v15.4S, v28.4S, v8.S[0]           // .....................*.........
        // sqrdmulh v13.4S, v5.4S, v2.S[3]       // ....................*..........
        // sub v17.4S, v7.4S, v15.4S             // .......................*.......
        // add v9.4S, v7.4S, v15.4S              // ........................*......
        // mls v20.4S, v13.4S, v8.S[0]           // ......................*........
        // str q9, [x0, #768]                    // ............................*..
        // add v7.4S, v11.4S, v30.4S             // ..........*....................
        // add v13.4S, v18.4S, v20.4S            // ..........................*....
        // sub v11.4S, v18.4S, v20.4S            // .........................*.....
        // str q11, [x0, #640]                   // .............................*.
        // sub v23.4S, v31.4S, v21.4S            // ....*..........................
        // str q13, [x0, #512]                   // ..............................*
        // str q17, [x0, #896]                   // ...........................*...
        // add v15.4S, v31.4S, v21.4S            // ...*...........................
        // str q7, [x0], #(16)                   // ...............*...............
        // str q22, [x0, #112]                   // ..................*............
        // str q15, [x0, #240]                   // ........*......................
        // str q23, [x0, #368]                   // .........*.....................


        restore inp, STACK0
        add inpp, inp, #64
        mov count, #8

        root0_tw .req v4
        root1_tw .req v5
        root2_tw .req v6
        root3_tw .req v7
        qform_root0_tw .req q4
        qform_root1_tw .req q5
        qform_root2_tw .req q6
        qform_root3_tw .req q7

        .p2align 2
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        ldr q12, [x4], #64                       // *...............................................................................................................
        ldr q4, [x2, #48]                        // .*..............................................................................................................
        ldr q3, [x2, #32]                        // ..*.............................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        ldr q21, [x2, #16]                       // ....*...........................................................................................................
        ldr q27, [x5, #160]                      // ...........................................................................*....................................
        ldr q14, [x2, #0]                        // ...*............................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        ldr q5, [x5, #128]                       // .......................................................................*........................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        ldr q25, [x1, #32]                       // ...........*....................................................................................................
        ldr q13, [x5, #176]                      // ...................................................................*............................................
        sqrdmulh v16.4S, v4.4S, v12.S[1]         // ......*.........................................................................................................
        mul v15.4S, v4.4S, v12.S[0]              // .......*........................................................................................................
        ldr q24, [x1, #48]                       // .............*..................................................................................................
        ldr q11, [x1, #0]                        // ................*...............................................................................................
        mul v10.4S, v3.4S, v12.S[0]              // .........*......................................................................................................
        sqrdmulh v1.4S, v3.4S, v12.S[1]          // ..........*.....................................................................................................
        ldr q0, [x5, #112]                       // .................................................*..............................................................
        ldr q7, [x5, #96]                        // .....................*..........................................................................................
        sqrdmulh v3.4S, v14.4S, v12.S[1]         // .................*..............................................................................................
        ldr q4, [x1, #16]                        // ..................*.............................................................................................
        mul v19.4S, v14.4S, v12.S[0]             // ......................*.........................................................................................
        sqrdmulh v29.4S, v21.4S, v12.S[1]        // ..............*.................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mls v15.4S, v16.4S, v8.S[0]              // ...............*................................................................................................
        mls v10.4S, v1.4S, v8.S[0]               // ...................*............................................................................................
        // gap                                   // ................................................................................................................
        mul v6.4S, v21.4S, v12.S[0]              // ............*...................................................................................................
        ldr q26, [x4, #-48]                      // ........*.......................................................................................................
        mls v19.4S, v3.4S, v8.S[0]               // ..............................*.................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sub v16.4S, v24.4S, v15.4S               // .......................*........................................................................................
        sub v3.4S, v25.4S, v10.4S                // ........................*.......................................................................................
        mls v6.4S, v29.4S, v8.S[0]               // ....................*...........................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v20.4S, v16.4S, v26.S[1]        // ...........................*....................................................................................
        mul v23.4S, v16.4S, v26.S[0]             // ..........................*.....................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v18.4S, v3.4S, v26.S[1]         // ................................*...............................................................................
        mul v21.4S, v3.4S, v26.S[0]              // ...............................*................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        add v3.4S, v24.4S, v15.4S                // ................................................*...............................................................
        mls v23.4S, v20.4S, v8.S[0]              // .................................*..............................................................................
        ldr q2, [x5, #16]                        // ........................................................................*.......................................
        // gap                                   // ................................................................................................................
        sub v17.4S, v4.4S, v6.4S                 // ....................................*...........................................................................
        mls v21.4S, v18.4S, v8.S[0]              // .......................................*........................................................................
        add v30.4S, v4.4S, v6.4S                 // ....................................................................*...........................................
        ldr q18, [x4, #-32]                      // .....*..........................................................................................................
        // gap                                   // ................................................................................................................
        add v6.4S, v25.4S, v10.4S                // .........................*......................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        ldr q28, [x4, #-16]                      // ...................................*............................................................................
        add v29.4S, v17.4S, v23.4S               // ........................................*.......................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mul v16.4S, v3.4S, v12.S[2]              // .....................................................................................*..........................
        sub v9.4S, v11.4S, v19.4S                // ......................................*.........................................................................
        sub v4.4S, v17.4S, v23.4S                // ..........................................*.....................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v15.4S, v29.4S, v18.S[3]        // ...........................................*....................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mul v20.4S, v29.4S, v18.S[2]             // ............................................*...................................................................
        mul v29.4S, v4.4S, v28.S[0]              // .............................................*..................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v4.4S, v4.4S, v28.S[1]          // ..............................................*.................................................................
        sqrdmulh v22.4S, v6.4S, v12.S[3]         // .............................*..................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v24.4S, v3.4S, v12.S[3]         // ..............................................................*.................................................
        mul v23.4S, v6.4S, v12.S[2]              // ............................*...................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mls v20.4S, v15.4S, v8.S[0]              // ..................................................*.............................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        add v3.4S, v9.4S, v21.4S                 // ...............................................*................................................................
        mls v29.4S, v4.4S, v8.S[0]               // ....................................................*...........................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sub v9.4S, v9.4S, v21.4S                 // ...................................................*............................................................
        mls v16.4S, v24.4S, v8.S[0]              // ..............................................................................................*.................
        // gap                                   // ................................................................................................................
        sub v15.4S, v3.4S, v20.4S                // ......................................................*.........................................................
        // gap                                   // ................................................................................................................
        add v21.4S, v3.4S, v20.4S                // .....................................................*..........................................................
        // gap                                   // ................................................................................................................
        sub v3.4S, v9.4S, v29.4S                 // ........................................................*.......................................................
        add v29.4S, v9.4S, v29.4S                // .......................................................*........................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mls v23.4S, v22.4S, v8.S[0]              // ..................................*.............................................................................
        // gap                                   // ................................................................................................................
        sub v4.4S, v30.4S, v16.4S                // ..................................................................................................*.............
        trn2 v24.4S, v21.4S, v15.4S              // .........................................................*......................................................
        trn2 v28.4S, v29.4S, v3.4S               // ...........................................................*....................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        trn1 v1.4S, v21.4S, v15.4S               // ..........................................................*.....................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        trn1 v14.4S, v29.4S, v3.4S               // ............................................................*...................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v3.4S, v4.4S, v18.S[1]          // ....................................................................................................*...........
        trn2 v29.2D, v24.2D, v28.2D              // .............................................................*..................................................
        add v17.4S, v11.4S, v19.4S               // .....................................*..........................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        trn1 v21.2D, v1.2D, v14.2D               // ...................................................................................*............................
        sqrdmulh v20.4S, v29.4S, v0.4S           // .................................................................*..............................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mul v9.4S, v29.4S, v7.4S                 // ................................................................*...............................................
        mul v29.4S, v4.4S, v18.S[0]              // ...................................................................................................*............
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        trn2 v4.2D, v1.2D, v14.2D                // ...............................................................*................................................
        trn1 v15.2D, v24.2D, v28.2D              // ..........................................................................*.....................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mls v9.4S, v20.4S, v8.S[0]               // ......................................................................*.........................................
        // gap                                   // ................................................................................................................
        ldr q20, [x5, #144]                      // .........................................................................*......................................
        sqrdmulh v0.4S, v4.4S, v0.4S             // .....................................................................*..........................................
        mul v4.4S, v4.4S, v7.4S                  // ..................................................................*.............................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        add v16.4S, v30.4S, v16.4S               // .................................................................................................*..............
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sub v30.4S, v15.4S, v9.4S                // ..............................................................................*.................................
        add v15.4S, v15.4S, v9.4S                // .............................................................................*..................................
        // gap                                   // ................................................................................................................
        mul v9.4S, v16.4S, v26.S[2]              // .......................................................................................................*........
        // gap                                   // ................................................................................................................
        mls v4.4S, v0.4S, v8.S[0]                // ............................................................................*...................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v20.4S, v15.4S, v20.4S          // ................................................................................*...............................
        mul v0.4S, v15.4S, v5.4S                 // ...............................................................................*................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v15.4S, v30.4S, v13.4S          // ..................................................................................*.............................
        mul v30.4S, v30.4S, v27.4S               // .................................................................................*..............................
        mls v29.4S, v3.4S, v8.S[0]               // ........................................................................................................*.......
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sub v3.4S, v21.4S, v4.4S                 // ........................................................................................*.......................
        sub v27.4S, v17.4S, v23.4S               // .........................................*......................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mls v0.4S, v20.4S, v8.S[0]               // ....................................................................................*...........................
        add v4.4S, v21.4S, v4.4S                 // .......................................................................................*........................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        mls v30.4S, v15.4S, v8.S[0]              // ......................................................................................*.........................
        sub v15.4S, v27.4S, v29.4S               // ..............................................................................................................*.
        add v13.4S, v17.4S, v23.4S               // ............................................................................................................*...
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        add v17.4S, v4.4S, v0.4S                 // ..........................................................................................*.....................
        // gap                                   // ................................................................................................................
        sub v23.4S, v4.4S, v0.4S                 // .........................................................................................*......................
        sub v0.4S, v3.4S, v30.4S                 // ...........................................................................................*....................
        add v20.4S, v3.4S, v30.4S                // ............................................................................................*...................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        sqrdmulh v16.4S, v16.4S, v26.S[3]        // ......................................................................................................*.........
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        trn2 v21.4S, v20.4S, v0.4S               // ...............................................................................................*................
        trn2 v30.4S, v17.4S, v23.4S              // .............................................................................................*..................
        add v3.4S, v27.4S, v29.4S                // .............................................................................................................*..
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        trn1 v4.2D, v30.2D, v21.2D               // ................................................................................................*...............
        trn2 v6.2D, v30.2D, v21.2D               // .........................................................................................................*......
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        // gap                                   // ................................................................................................................
        str q4, [x2, #16]                        // .....................................................................................................*..........
        ldr q19, [x5, #32]                       // ...............................................................................................................*
        mls v9.4S, v16.4S, v8.S[0]               // ..........................................................................................................*.....
        trn1 v1.4S, v20.4S, v0.4S                // ...........................................................................................................*....

        // original source code
        // ldr q11, [x4], #64                     // *...............................................................................................................
        // ldr q12, [x2, #48]                     // .*..............................................................................................................
        // ldr q14, [x2, #32]                     // ..*.............................................................................................................
        // ldr q29, [x2, #0]                      // .....*..........................................................................................................
        // ldr q28, [x2, #16]                     // ...*............................................................................................................
        // ldr q6, [x4, #-32]                     // .......................................*........................................................................
        // sqrdmulh v21.4S, v12.4S, v11.S[1]      // .........*......................................................................................................
        // mul v4.4S, v12.4S, v11.S[0]            // ..........*.....................................................................................................
        // ldr q31, [x4, #-48]                    // ........................*.......................................................................................
        // mul v16.4S, v14.4S, v11.S[0]           // .............*..................................................................................................
        // sqrdmulh v22.4S, v14.4S, v11.S[1]      // ..............*.................................................................................................
        // ldr q15, [x1, #32]                     // .......*........................................................................................................
        // mul v3.4S, v28.4S, v11.S[0]            // .......................*........................................................................................
        // ldr q27, [x1, #48]                     // ...........*....................................................................................................
        // sqrdmulh v1.4S, v28.4S, v11.S[1]       // ....................*...........................................................................................
        // mls v4.4S, v21.4S, v8.S[0]             // .....................*..........................................................................................
        // ldr q28, [x1, #0]                      // ............*...................................................................................................
        // sqrdmulh v26.4S, v29.4S, v11.S[1]      // .................*..............................................................................................
        // ldr q21, [x1, #16]                     // ..................*.............................................................................................
        // mls v16.4S, v22.4S, v8.S[0]            // ......................*.........................................................................................
        // mls v3.4S, v1.4S, v8.S[0]              // ............................*...................................................................................
        // ldr q20, [x5, #96]                     // ................*...............................................................................................
        // mul v10.4S, v29.4S, v11.S[0]           // ...................*............................................................................................
        // sub v13.4S, v27.4S, v4.4S              // ..........................*.....................................................................................
        // sub v14.4S, v15.4S, v16.4S             // ...........................*....................................................................................
        // add v23.4S, v15.4S, v16.4S             // ........................................*.......................................................................
        // mul v9.4S, v13.4S, v31.S[0]            // ..............................*.................................................................................
        // sqrdmulh v22.4S, v13.4S, v31.S[1]      // .............................*..................................................................................
        // mul v29.4S, v23.4S, v11.S[2]           // ....................................................*...........................................................
        // sqrdmulh v7.4S, v23.4S, v11.S[3]       // ..................................................*.............................................................
        // mls v10.4S, v26.4S, v8.S[0]            // .........................*......................................................................................
        // mul v15.4S, v14.4S, v31.S[0]           // ................................*...............................................................................
        // sqrdmulh v26.4S, v14.4S, v31.S[1]      // ...............................*................................................................................
        // mls v9.4S, v22.4S, v8.S[0]             // ..................................*.............................................................................
        // mls v29.4S, v7.4S, v8.S[0]             // ..............................................................*.................................................
        // ldr q14, [x4, #-16]                    // .........................................*......................................................................
        // sub v7.4S, v21.4S, v3.4S               // ....................................*...........................................................................
        // add v13.4S, v28.4S, v10.4S             // ......................................................................*.........................................
        // sub v5.4S, v28.4S, v10.4S              // ............................................*...................................................................
        // mls v15.4S, v26.4S, v8.S[0]            // .....................................*..........................................................................
        // add v16.4S, v7.4S, v9.4S               // ..........................................*.....................................................................
        // sub v22.4S, v13.4S, v29.4S             // ............................................................................................*...................
        // sub v28.4S, v7.4S, v9.4S               // .............................................*..................................................................
        // sqrdmulh v23.4S, v16.4S, v6.S[3]       // ..............................................*.................................................................
        // mul v10.4S, v16.4S, v6.S[2]            // ...............................................*................................................................
        // mul v16.4S, v28.4S, v14.S[0]           // ................................................*...............................................................
        // sqrdmulh v28.4S, v28.4S, v14.S[1]      // .................................................*..............................................................
        // add v9.4S, v5.4S, v15.4S               // ......................................................*.........................................................
        // add v27.4S, v27.4S, v4.4S              // .................................*..............................................................................
        // ldr q26, [x5, #112]                    // ...............*................................................................................................
        // mls v10.4S, v23.4S, v8.S[0]            // .....................................................*..........................................................
        // sub v14.4S, v5.4S, v15.4S              // ........................................................*.......................................................
        // mls v16.4S, v28.4S, v8.S[0]            // .......................................................*........................................................
        // add v28.4S, v9.4S, v10.4S              // ...........................................................*....................................................
        // sub v10.4S, v9.4S, v10.4S              // ..........................................................*.....................................................
        // add v9.4S, v14.4S, v16.4S              // .............................................................*..................................................
        // sub v23.4S, v14.4S, v16.4S             // ............................................................*...................................................
        // trn2 v17.4S, v28.4S, v10.4S            // ................................................................*...............................................
        // trn1 v10.4S, v28.4S, v10.4S            // ..................................................................*.............................................
        // trn2 v25.4S, v9.4S, v23.4S             // .................................................................*..............................................
        // trn1 v14.4S, v9.4S, v23.4S             // ...................................................................*............................................
        // trn2 v2.2D, v17.2D, v25.2D             // .....................................................................*..........................................
        // sqrdmulh v9.4S, v27.4S, v11.S[3]       // ...................................................*............................................................
        // trn2 v18.2D, v10.2D, v14.2D            // ...........................................................................*....................................
        // mul v16.4S, v2.4S, v20.4S              // .........................................................................*......................................
        // sqrdmulh v2.4S, v2.4S, v26.4S          // ........................................................................*.......................................
        // mul v23.4S, v18.4S, v20.4S             // ................................................................................*...............................
        // ldr q20, [x5, #176]                    // ........*.......................................................................................................
        // add v3.4S, v21.4S, v3.4S               // ......................................*.........................................................................
        // sqrdmulh v18.4S, v18.4S, v26.4S        // ...............................................................................*................................
        // mls v16.4S, v2.4S, v8.S[0]             // .............................................................................*..................................
        // ldr q21, [x5, #128]                    // ......*.........................................................................................................
        // ldr q2, [x5, #16]                      // ...................................*............................................................................
        // ldr q0, [x5, #144]                     // ..............................................................................*.................................
        // trn1 v26.2D, v17.2D, v25.2D            // ............................................................................*...................................
        // ldr q12, [x5, #160]                    // ....*...........................................................................................................
        // mls v23.4S, v18.4S, v8.S[0]            // .....................................................................................*..........................
        // add v7.4S, v26.4S, v16.4S              // ...................................................................................*............................
        // sub v24.4S, v26.4S, v16.4S             // ..................................................................................*.............................
        // mul v17.4S, v7.4S, v21.4S              // .......................................................................................*........................
        // sqrdmulh v0.4S, v7.4S, v0.4S           // ......................................................................................*.........................
        // mul v7.4S, v24.4S, v12.4S              // .........................................................................................*......................
        // sqrdmulh v16.4S, v24.4S, v20.4S        // ........................................................................................*.......................
        // trn1 v20.2D, v10.2D, v14.2D            // .......................................................................*........................................
        // mls v17.4S, v0.4S, v8.S[0]             // .............................................................................................*..................
        // mul v10.4S, v27.4S, v11.S[2]           // ...........................................*....................................................................
        // mls v7.4S, v16.4S, v8.S[0]             // ...............................................................................................*................
        // add v16.4S, v20.4S, v23.4S             // ..............................................................................................*.................
        // sub v24.4S, v20.4S, v23.4S             // ...........................................................................................*....................
        // sub v23.4S, v16.4S, v17.4S             // ...................................................................................................*............
        // add v17.4S, v16.4S, v17.4S             // ..................................................................................................*.............
        // sub v26.4S, v24.4S, v7.4S              // ....................................................................................................*...........
        // add v11.4S, v24.4S, v7.4S              // .....................................................................................................*..........
        // trn2 v16.4S, v17.4S, v23.4S            // ........................................................................................................*.......
        // mls v10.4S, v9.4S, v8.S[0]             // .........................................................*......................................................
        // trn2 v27.4S, v11.4S, v26.4S            // .......................................................................................................*........
        // trn1 v9.2D, v16.2D, v27.2D             // ..........................................................................................................*.....
        // add v18.4S, v3.4S, v10.4S              // .................................................................................*..............................
        // sub v7.4S, v3.4S, v10.4S               // ...............................................................*................................................
        // mul v15.4S, v7.4S, v6.S[0]             // ..........................................................................*.....................................
        // sqrdmulh v7.4S, v7.4S, v6.S[1]         // ....................................................................*...........................................
        // str q9, [x2, #16]                      // ............................................................................................................*...
        // sqrdmulh v28.4S, v18.4S, v31.S[3]      // ......................................................................................................*.........
        // mul v9.4S, v18.4S, v31.S[2]            // ....................................................................................*...........................
        // mls v15.4S, v7.4S, v8.S[0]             // ..........................................................................................*.....................
        // trn2 v6.2D, v16.2D, v27.2D             // ...........................................................................................................*....
        // mls v9.4S, v28.4S, v8.S[0]             // ..............................................................................................................*.
        // trn1 v1.4S, v11.4S, v26.4S             // ...............................................................................................................*
        // add v13.4S, v13.4S, v29.4S             // .................................................................................................*..............
        // add v3.4S, v22.4S, v15.4S              // .........................................................................................................*......
        // sub v15.4S, v22.4S, v15.4S             // ................................................................................................*...............
        // ldr q19, [x5, #32]                     // .............................................................................................................*..

        sub count, count, #1
layer45678_start:
        add v24.4S, v13.4S, v9.4S                // ........................................................*...........................................................................................................
        ldr q11, [x4], #64                       // ........e...........................................................................................................................................................
        trn1 v16.4S, v17.4S, v23.4S              // ....................................................................................................................................................*...............
        ldr q12, [x2, #176]                      // .......e............................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sub v7.4S, v13.4S, v9.4S                 // .......................................................*............................................................................................................
        ldr q14, [x2, #160]                      // ......e.............................................................................................................................................................
        trn1 v18.4S, v3.4S, v15.4S               // ..........................................................................*.........................................................................................
        ldr q29, [x2, #128]                      // ....e...............................................................................................................................................................
        trn1 v9.2D, v16.2D, v1.2D                // ..........................................................................................................................................................*.........
        ldr q28, [x2, #144]                      // .....e..............................................................................................................................................................
        trn2 v0.4S, v3.4S, v15.4S                // ...........................................................................*........................................................................................
        ldr q30, [x5, #48]                       // ...........................................................................................*........................................................................
        trn2 v3.2D, v16.2D, v1.2D                // ........................................................................................................................................................*...........
        trn2 v25.4S, v24.4S, v7.4S               // .........................................................................*..........................................................................................
        str q6, [x2, #48]                        // ...................................................................................................................................................................*
        // gap                                   // ....................................................................................................................................................................
        ldr q6, [x4, #-32]                       // ..........e.........................................................................................................................................................
        sqrdmulh v21.4S, v12.4S, v11.S[1]        // ............................e.......................................................................................................................................
        mul v4.4S, v12.4S, v11.S[0]              // ...........................e........................................................................................................................................
        str q3, [x2, #32]                        // ..................................................................................................................................................................*.
        ldr q31, [x4, #-48]                      // .........e..........................................................................................................................................................
        mul v16.4S, v14.4S, v11.S[0]             // ......................e.............................................................................................................................................
        sqrdmulh v22.4S, v14.4S, v11.S[1]        // .......................e............................................................................................................................................
        ldr q15, [x1, #160]                      // ..e.................................................................................................................................................................
        mul v3.4S, v28.4S, v11.S[0]              // .................e..................................................................................................................................................
        ldr q27, [x1, #176]                      // ...e................................................................................................................................................................
        sqrdmulh v1.4S, v28.4S, v11.S[1]         // ..................e.................................................................................................................................................
        mls v4.4S, v21.4S, v8.S[0]               // .............................e......................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        ldr q28, [x1, #128]                      // e...................................................................................................................................................................
        sqrdmulh v26.4S, v29.4S, v11.S[1]        // .............e......................................................................................................................................................
        ldr q21, [x1, #144]                      // .e..................................................................................................................................................................
        trn1 v17.4S, v24.4S, v7.4S               // ........................................................................*...........................................................................................
        mls v16.4S, v22.4S, v8.S[0]              // ........................e...........................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v3.4S, v1.4S, v8.S[0]                // ...................e................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        ldr q20, [x5, #288]                      // ..................................................................................................................e.................................................
        mul v10.4S, v29.4S, v11.S[0]             // ............e.......................................................................................................................................................
        trn2 v1.2D, v17.2D, v18.2D               // ............................................................................*.......................................................................................
        sub v13.4S, v27.4S, v4.4S                // ..............................e.....................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        str q9, [x2], #128                       // ................................................................................................................................................................*...
        sub v14.4S, v15.4S, v16.4S               // .........................e..........................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        add v23.4S, v15.4S, v16.4S               // ..........................e.........................................................................................................................................
        ldr q12, [x5], #(12*16)                  // ........................................................................................*...........................................................................
        mul v9.4S, v13.4S, v31.S[0]              // ...............................................e....................................................................................................................
        sqrdmulh v22.4S, v13.4S, v31.S[1]        // ................................................e...................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mul v29.4S, v23.4S, v11.S[2]             // ................................e...................................................................................................................................
        sqrdmulh v7.4S, v23.4S, v11.S[3]         // .................................e..................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v10.4S, v26.4S, v8.S[0]              // ..............e.....................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mul v15.4S, v14.4S, v31.S[0]             // ..........................................e.........................................................................................................................
        sqrdmulh v26.4S, v14.4S, v31.S[1]        // ...........................................e........................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v9.4S, v22.4S, v8.S[0]               // .................................................e..................................................................................................................
        ldr q24, [x5, #-112]                     // .............................................................................................*......................................................................
        mls v29.4S, v7.4S, v8.S[0]               // ..................................e.................................................................................................................................
        ldr q14, [x4, #-16]                      // ...........e........................................................................................................................................................
        sub v7.4S, v21.4S, v3.4S                 // ....................e...............................................................................................................................................
        add v13.4S, v28.4S, v10.4S               // ................e...................................................................................................................................................
        sub v5.4S, v28.4S, v10.4S                // ...............e....................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v15.4S, v26.4S, v8.S[0]              // ............................................e.......................................................................................................................
        add v16.4S, v7.4S, v9.4S                 // ...................................................e................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sub v22.4S, v13.4S, v29.4S               // ...................................e................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sub v28.4S, v7.4S, v9.4S                 // ..................................................e.................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sqrdmulh v23.4S, v16.4S, v6.S[3]         // ...............................................................e....................................................................................................
        mul v10.4S, v16.4S, v6.S[2]              // ..............................................................e.....................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mul v16.4S, v28.4S, v14.S[0]             // ...................................................................e................................................................................................
        sqrdmulh v28.4S, v28.4S, v14.S[1]        // ....................................................................e...............................................................................................
        // gap                                   // ....................................................................................................................................................................
        add v9.4S, v5.4S, v15.4S                 // ..............................................e.....................................................................................................................
        add v27.4S, v27.4S, v4.4S                // ...............................e....................................................................................................................................
        ldr q26, [x5, #112]                      // ...................................................................................................................e................................................
        // gap                                   // ....................................................................................................................................................................
        mls v10.4S, v23.4S, v8.S[0]              // ................................................................e...................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sub v14.4S, v5.4S, v15.4S                // .............................................e......................................................................................................................
        trn1 v7.2D, v25.2D, v0.2D                // ...............................................................................*....................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v16.4S, v28.4S, v8.S[0]              // .....................................................................e..............................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn2 v4.2D, v25.2D, v0.2D                // .............................................................................*......................................................................................
        // gap                                   // ....................................................................................................................................................................
        sqrdmulh v0.4S, v1.4S, v2.4S             // ...............................................................................................*....................................................................
        add v28.4S, v9.4S, v10.4S                // ..................................................................e.................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sub v10.4S, v9.4S, v10.4S                // .................................................................e..................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        add v9.4S, v14.4S, v16.4S                // .......................................................................e............................................................................................
        sub v23.4S, v14.4S, v16.4S               // ......................................................................e.............................................................................................
        trn1 v15.2D, v17.2D, v18.2D              // ..............................................................................*.....................................................................................
        trn2 v17.4S, v28.4S, v10.4S              // .................................................................................e..................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn1 v10.4S, v28.4S, v10.4S              // ................................................................................e...................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn2 v25.4S, v9.4S, v23.4S               // ...................................................................................e................................................................................
        trn1 v14.4S, v9.4S, v23.4S               // ..................................................................................e.................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sqrdmulh v5.4S, v4.4S, v2.4S             // ....................................................................................................*...............................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn2 v2.2D, v17.2D, v25.2D               // .....................................................................................e..............................................................................
        sqrdmulh v9.4S, v27.4S, v11.S[3]         // ......................................e.............................................................................................................................
        mul v28.4S, v4.4S, v12.4S                // ...................................................................................................*................................................................
        trn2 v18.2D, v10.2D, v14.2D              // ....................................................................................e...............................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mul v16.4S, v2.4S, v20.4S                // .............................................................................................................................e......................................
        sqrdmulh v2.4S, v2.4S, v26.4S            // ..............................................................................................................................e.....................................
        mul v23.4S, v18.4S, v20.4S               // ........................................................................................................................e...........................................
        mul v4.4S, v1.4S, v12.4S                 // ..............................................................................................*.....................................................................
        ldr q20, [x5, #176]                      // .......................................................................................................................e............................................
        // gap                                   // ....................................................................................................................................................................
        ldr q1, [x5, #-128]                      // ............................................................................................*.......................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v28.4S, v5.4S, v8.S[0]               // .....................................................................................................*..............................................................
        add v3.4S, v21.4S, v3.4S                 // .....................e..............................................................................................................................................
        sqrdmulh v18.4S, v18.4S, v26.4S          // .........................................................................................................................e..........................................
        // gap                                   // ....................................................................................................................................................................
        mls v16.4S, v2.4S, v8.S[0]               // ...............................................................................................................................e....................................
        ldr q21, [x5, #128]                      // ....................................................................................................................e...............................................
        mls v4.4S, v0.4S, v8.S[0]                // ................................................................................................*...................................................................
        ldr q2, [x5, #16]                        // .........................................................................................e..........................................................................
        ldr q0, [x5, #144]                       // .....................................................................................................................e..............................................
        trn1 v26.2D, v17.2D, v25.2D              // .......................................................................................e............................................................................
        add v5.4S, v7.4S, v28.4S                 // .......................................................................................................*............................................................
        // gap                                   // ....................................................................................................................................................................
        ldr q12, [x5, #160]                      // ......................................................................................................................e.............................................
        sub v25.4S, v7.4S, v28.4S                // ......................................................................................................*.............................................................
        mls v23.4S, v18.4S, v8.S[0]              // ..........................................................................................................................e.........................................
        // gap                                   // ....................................................................................................................................................................
        add v7.4S, v26.4S, v16.4S                // .................................................................................................................................e..................................
        // gap                                   // ....................................................................................................................................................................
        sqrdmulh v28.4S, v25.4S, v24.4S          // ..............................................................................................................*.....................................................
        sub v24.4S, v26.4S, v16.4S               // ................................................................................................................................e...................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mul v17.4S, v7.4S, v21.4S                // ..................................................................................................................................e.................................
        sqrdmulh v0.4S, v7.4S, v0.4S             // ...................................................................................................................................e................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mul v7.4S, v24.4S, v12.4S                // .......................................................................................................................................e............................
        sqrdmulh v16.4S, v24.4S, v20.4S          // ........................................................................................................................................e...........................
        // gap                                   // ....................................................................................................................................................................
        sqrdmulh v21.4S, v5.4S, v30.4S           // .........................................................................................................*..........................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn1 v20.2D, v10.2D, v14.2D              // ......................................................................................e.............................................................................
        mls v17.4S, v0.4S, v8.S[0]               // ....................................................................................................................................e...............................
        mul v10.4S, v27.4S, v11.S[2]             // .....................................e..............................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v7.4S, v16.4S, v8.S[0]               // .........................................................................................................................................e..........................
        add v16.4S, v20.4S, v23.4S               // ............................................................................................................................e.......................................
        sub v24.4S, v20.4S, v23.4S               // ...........................................................................................................................e........................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mul v20.4S, v25.4S, v1.4S                // .............................................................................................................*......................................................
        // gap                                   // ....................................................................................................................................................................
        sub v23.4S, v16.4S, v17.4S               // .....................................................................................................................................e..............................
        add v17.4S, v16.4S, v17.4S               // ......................................................................................................................................e.............................
        // gap                                   // ....................................................................................................................................................................
        sub v26.4S, v24.4S, v7.4S                // ..........................................................................................................................................e.........................
        add v11.4S, v24.4S, v7.4S                // ...........................................................................................................................................e........................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn2 v16.4S, v17.4S, v23.4S              // .....................................................................................................................................................e..............
        mul v30.4S, v5.4S, v19.4S                // ........................................................................................................*...........................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v10.4S, v9.4S, v8.S[0]               // .......................................e............................................................................................................................
        trn2 v27.4S, v11.4S, v26.4S              // .......................................................................................................................................................e............
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sub v14.4S, v15.4S, v4.4S                // .................................................................................................*..................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        mls v20.4S, v28.4S, v8.S[0]              // ...............................................................................................................*....................................................
        trn1 v9.2D, v16.2D, v27.2D               // ...........................................................................................................................................................e........
        mls v30.4S, v21.4S, v8.S[0]              // ..........................................................................................................*.........................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        add v18.4S, v3.4S, v10.4S                // .........................................e..........................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        add v28.4S, v15.4S, v4.4S                // ..................................................................................................*.................................................................
        // gap                                   // ....................................................................................................................................................................
        sub v7.4S, v3.4S, v10.4S                 // ........................................e...........................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        sub v25.4S, v14.4S, v20.4S               // ................................................................................................................*...................................................
        // gap                                   // ....................................................................................................................................................................
        sub v24.4S, v28.4S, v30.4S               // ...........................................................................................................*........................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        add v20.4S, v14.4S, v20.4S               // .................................................................................................................*..................................................
        mul v15.4S, v7.4S, v6.S[0]               // .........................................................e..........................................................................................................
        // gap                                   // ....................................................................................................................................................................
        add v0.4S, v28.4S, v30.4S                // ............................................................................................................*.......................................................
        // gap                                   // ....................................................................................................................................................................
        sqrdmulh v7.4S, v7.4S, v6.S[1]           // ..........................................................e.........................................................................................................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn1 v14.4S, v20.4S, v25.4S              // ..............................................................................................................................................*.....................
        trn2 v5.4S, v20.4S, v25.4S               // ...............................................................................................................................................*....................
        trn2 v4.4S, v0.4S, v24.4S                // .............................................................................................................................................*......................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        str q9, [x2, #16]                        // .................................................................................................................................................................e..
        sqrdmulh v28.4S, v18.4S, v31.S[3]        // .....................................................e..............................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn1 v24.4S, v0.4S, v24.4S               // ............................................................................................................................................*.......................
        // gap                                   // ....................................................................................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn2 v21.2D, v4.2D, v5.2D                // .................................................................................................................................................*..................
        mul v9.4S, v18.4S, v31.S[2]              // ....................................................e...............................................................................................................
        mls v15.4S, v7.4S, v8.S[0]               // ...........................................................e........................................................................................................
        // gap                                   // ....................................................................................................................................................................
        trn1 v31.2D, v24.2D, v14.2D              // ..................................................................................................................................................*.................
        // gap                                   // ....................................................................................................................................................................
        trn2 v6.2D, v16.2D, v27.2D               // .........................................................................................................................................................e..........
        trn1 v0.2D, v4.2D, v5.2D                 // ...................................................................................................................................................*................
        // gap                                   // ....................................................................................................................................................................
        str q21, [x1, #48]                       // ...............................................................................................................................................................*....
        mls v9.4S, v28.4S, v8.S[0]               // ......................................................e.............................................................................................................
        // gap                                   // ....................................................................................................................................................................
        str q31, [x1], #128                      // ............................................................................................................................................................*.......
        trn2 v16.2D, v24.2D, v14.2D              // ................................................................................................................................................*...................
        // gap                                   // ....................................................................................................................................................................
        str q0, [x1, #-112]                      // .............................................................................................................................................................*......
        trn1 v1.4S, v11.4S, v26.4S               // ......................................................................................................................................................e.............
        add v13.4S, v13.4S, v29.4S               // ....................................e...............................................................................................................................
        add v3.4S, v22.4S, v15.4S                // .............................................................e......................................................................................................
        sub v15.4S, v22.4S, v15.4S               // ............................................................e.......................................................................................................
        str q16, [x1, #-96]                      // ..............................................................................................................................................................*.....
        ldr q19, [x5, #32]                       // ..........................................................................................e.........................................................................

        // original source code
        // ldr q9, [x1, #(16*0)]                  // ..........................e........................................................................................................................................|..........................e.......................................................................................................................................
        // ldr q10, [x1, #(16*1)]                 // ............................e......................................................................................................................................|............................e.....................................................................................................................................
        // ldr q11, [x1, #(16*2)]                 // .....................e.............................................................................................................................................|.....................e............................................................................................................................................
        // ldr q12, [x1, #(16*3)]                 // .......................e...........................................................................................................................................|.......................e..........................................................................................................................................
        // ldr q13, [x2, #(16*0)]                 // ......e............................................................................................................................................................|......e...........................................................................................................................................................
        // ldr q14, [x2, #(16*1)]                 // ........e..........................................................................................................................................................|........e.........................................................................................................................................................
        // ldr q15, [x2, #(16*2)]                 // ....e..............................................................................................................................................................|....e.............................................................................................................................................................
        // ldr q16, [x2, #(16*3)]                 // ..e................................................................................................................................................................|..e...............................................................................................................................................................
        // ldr q0, [x4], #64                      // e..................................................................................................................................................................|e.................................................................................................................................................................
        // ldr q1, [x4, #(-64 + 16)]              // ..................e................................................................................................................................................|..................e...............................................................................................................................................
        // ldr q2, [x4, #(-64 + 32)]              // ..............e....................................................................................................................................................|..............e...................................................................................................................................................
        // ldr q3, [x4, #(-64 + 48)]              // ..................................................e................................................................................................................|..................................................e...............................................................................................................
        // mul v24.4s, v13.4s, v0.s[0]            // .................................e.................................................................................................................................|.................................e................................................................................................................................
        // sqrdmulh v13.4s, v13.4s, v0.s[1]       // ...........................e.......................................................................................................................................|...........................e......................................................................................................................................
        // mls v24.4s, v13.4s, v8.s[0]            // ............................................e......................................................................................................................|............................................e.....................................................................................................................
        // sub     v13.4s,    v9.4s, v24.4s       // .....................................................e.............................................................................................................|.....................................................e............................................................................................................
        // add     v9.4s,    v9.4s, v24.4s        // ....................................................e..............................................................................................................|....................................................e.............................................................................................................
        // mul v24.4s, v14.4s, v0.s[0]            // ......................e............................................................................................................................................|......................e...........................................................................................................................................
        // sqrdmulh v14.4s, v14.4s, v0.s[1]       // ........................e..........................................................................................................................................|........................e.........................................................................................................................................
        // mls v24.4s, v14.4s, v8.s[0]            // ...............................e...................................................................................................................................|...............................e..................................................................................................................................
        // sub     v14.4s,    v10.4s, v24.4s      // ...................................................e...............................................................................................................|...................................................e..............................................................................................................
        // add     v10.4s,    v10.4s, v24.4s      // ............................................................................................e......................................................................|............................................................................................e.....................................................................
        // mul v24.4s, v15.4s, v0.s[0]            // ...................e...............................................................................................................................................|...................e..............................................................................................................................................
        // sqrdmulh v15.4s, v15.4s, v0.s[1]       // ....................e..............................................................................................................................................|....................e.............................................................................................................................................
        // mls v24.4s, v15.4s, v8.s[0]            // ..............................e....................................................................................................................................|..............................e...................................................................................................................................
        // sub     v15.4s,    v11.4s, v24.4s      // .....................................e.............................................................................................................................|.....................................e............................................................................................................................
        // add     v11.4s,    v11.4s, v24.4s      // ......................................e............................................................................................................................|......................................e...........................................................................................................................
        // mul v24.4s, v16.4s, v0.s[0]            // ................e..................................................................................................................................................|................e.................................................................................................................................................
        // sqrdmulh v16.4s, v16.4s, v0.s[1]       // ...............e...................................................................................................................................................|...............e..................................................................................................................................................
        // mls v24.4s, v16.4s, v8.s[0]            // .........................e.........................................................................................................................................|.........................e........................................................................................................................................
        // sub     v16.4s,    v12.4s, v24.4s      // ...................................e...............................................................................................................................|...................................e..............................................................................................................................
        // add     v12.4s,    v12.4s, v24.4s      // ...............................................................e...................................................................................................|...............................................................e..................................................................................................
        // mul v24.4s, v11.4s, v0.s[2]            // ..........................................e........................................................................................................................|..........................................e.......................................................................................................................
        // sqrdmulh v11.4s, v11.4s, v0.s[3]       // ...........................................e.......................................................................................................................|...........................................e......................................................................................................................
        // mls v24.4s, v11.4s, v8.s[0]            // .................................................e.................................................................................................................|.................................................e................................................................................................................
        // sub     v11.4s,    v9.4s, v24.4s       // ........................................................e..........................................................................................................|........................................................e.........................................................................................................
        // add     v9.4s,    v9.4s, v24.4s        // ..............................................................................................................................................................e....|..............................................................................................................................................................e...
        // mul v24.4s, v12.4s, v0.s[2]            // ..................................................................................................................e................................................|..................................................................................................................e...............................................
        // sqrdmulh v12.4s, v12.4s, v0.s[3]       // ..................................................................................e................................................................................|..................................................................................e...............................................................................
        // mls v24.4s, v12.4s, v8.s[0]            // .............................................................................................................................e.....................................|.............................................................................................................................e....................................
        // sub     v12.4s,    v10.4s, v24.4s      // .....................................................................................................................................e.............................|.....................................................................................................................................e............................
        // add     v10.4s,    v10.4s, v24.4s      // ...................................................................................................................................e...............................|...................................................................................................................................e..............................
        // mul v24.4s, v15.4s, v1.s[0]            // .............................................e.....................................................................................................................|.............................................e....................................................................................................................
        // sqrdmulh v15.4s, v15.4s, v1.s[1]       // ..............................................e....................................................................................................................|..............................................e...................................................................................................................
        // mls v24.4s, v15.4s, v8.s[0]            // ......................................................e............................................................................................................|......................................................e...........................................................................................................
        // sub     v15.4s,    v13.4s, v24.4s      // ..................................................................e................................................................................................|..................................................................e...............................................................................................
        // add     v13.4s,    v13.4s, v24.4s      // ..............................................................e....................................................................................................|..............................................................e...................................................................................................
        // mul v24.4s, v16.4s, v1.s[0]            // ........................................e..........................................................................................................................|........................................e.........................................................................................................................
        // sqrdmulh v16.4s, v16.4s, v1.s[1]       // .........................................e.........................................................................................................................|.........................................e........................................................................................................................
        // mls v24.4s, v16.4s, v8.s[0]            // ...............................................e...................................................................................................................|...............................................e..................................................................................................................
        // sub     v16.4s,    v14.4s, v24.4s      // .........................................................e.........................................................................................................|.........................................................e........................................................................................................
        // add     v14.4s,    v14.4s, v24.4s      // .......................................................e...........................................................................................................|.......................................................e..........................................................................................................
        // mul v24.4s, v10.4s, v1.s[2]            // ...................................................................................................................................................e...............|...................................................................................................................................................e..............
        // sqrdmulh v10.4s, v10.4s, v1.s[3]       // ................................................................................................................................................e..................|................................................................................................................................................e.................
        // mls v24.4s, v10.4s, v8.s[0]            // .........................................................................................................................................................e.........|.........................................................................................................................................................e........
        // sub     v10.4s,    v9.4s, v24.4s       // ...*...............................................................................................................................................................|...*..............................................................................................................................................................
        // add     v9.4s,    v9.4s, v24.4s        // ...................................................................................................................................................................*..................................................................................................................................................................
        // mul v24.4s, v12.4s, v2.s[0]            // .........................................................................................................................................e.........................|.........................................................................................................................................e........................
        // sqrdmulh v12.4s, v12.4s, v2.s[1]       // ...........................................................................................................................................e.......................|...........................................................................................................................................e......................
        // mls v24.4s, v12.4s, v8.s[0]            // ....................................................................................................................................................e..............|....................................................................................................................................................e.............
        // sub     v12.4s,    v11.4s, v24.4s      // ................................................................................................................................................................e..|................................................................................................................................................................e.
        // add     v11.4s,    v11.4s, v24.4s      // ...............................................................................................................................................................e...|...............................................................................................................................................................e..
        // mul v24.4s, v14.4s, v2.s[2]            // ...........................................................e.......................................................................................................|...........................................................e......................................................................................................
        // sqrdmulh v14.4s, v14.4s, v2.s[3]       // ..........................................................e........................................................................................................|..........................................................e.......................................................................................................
        // mls v24.4s, v14.4s, v8.s[0]            // .................................................................e.................................................................................................|.................................................................e................................................................................................
        // sub     v14.4s,    v13.4s, v24.4s      // ........................................................................e..........................................................................................|........................................................................e.........................................................................................
        // add     v13.4s,    v13.4s, v24.4s      // .......................................................................e...........................................................................................|.......................................................................e..........................................................................................
        // mul v24.4s, v16.4s, v3.s[0]            // ............................................................e......................................................................................................|............................................................e.....................................................................................................
        // sqrdmulh v16.4s, v16.4s, v3.s[1]       // .............................................................e.....................................................................................................|.............................................................e....................................................................................................
        // mls v24.4s, v16.4s, v8.s[0]            // ....................................................................e..............................................................................................|....................................................................e.............................................................................................
        // sub     v16.4s,    v15.4s, v24.4s      // ..........................................................................e........................................................................................|..........................................................................e.......................................................................................
        // add     v15.4s,    v15.4s, v24.4s      // .........................................................................e.........................................................................................|.........................................................................e........................................................................................
        // trn1 v25.4s, v9.4s, v10.4s             // .............................*.....................................................................................................................................|.............................*....................................................................................................................................
        // trn2 v26.4s, v9.4s, v10.4s             // ............*......................................................................................................................................................|............*.....................................................................................................................................................
        // trn1 v27.4s, v11.4s, v12.4s            // .....*.............................................................................................................................................................|.....*............................................................................................................................................................
        // trn2 v28.4s, v11.4s, v12.4s            // .........*.........................................................................................................................................................|.........*........................................................................................................................................................
        // trn2 v11.2d, v25.2d, v27.2d            // ..................................*................................................................................................................................|..................................*...............................................................................................................................
        // trn2 v12.2d, v26.2d, v28.2d            // .....................................................................*.............................................................................................|.....................................................................*............................................................................................
        // trn1 v9.2d, v25.2d, v27.2d             // ...........................................................................*.......................................................................................|...........................................................................*......................................................................................
        // trn1 v10.2d, v26.2d, v28.2d            // ...................................................................*...............................................................................................|...................................................................*..............................................................................................
        // trn1 v25.4s, v13.4s, v14.4s            // .............................................................................e.....................................................................................|.............................................................................e....................................................................................
        // trn2 v26.4s, v13.4s, v14.4s            // ............................................................................e......................................................................................|............................................................................e.....................................................................................
        // trn1 v27.4s, v15.4s, v16.4s            // ...............................................................................e...................................................................................|...............................................................................e..................................................................................
        // trn2 v28.4s, v15.4s, v16.4s            // ..............................................................................e....................................................................................|..............................................................................e...................................................................................
        // trn2 v15.2d, v25.2d, v27.2d            // ....................................................................................e..............................................................................|....................................................................................e.............................................................................
        // trn2 v16.2d, v26.2d, v28.2d            // .................................................................................e.................................................................................|.................................................................................e................................................................................
        // trn1 v13.2d, v25.2d, v27.2d            // ................................................................................................................e..................................................|................................................................................................................e.................................................
        // trn1 v14.2d, v26.2d, v28.2d            // ...................................................................................................e...............................................................|...................................................................................................e..............................................................
        // ldr q0, [x5], #(12*16)                 // .......................................*...........................................................................................................................|.......................................*..........................................................................................................................
        // ldr q4, [x5, #(-12*16 + 1*16)]         // .................................................................................................e.................................................................|.................................................................................................e................................................................
        // ldr q1, [x5, #(-12*16 + 2*16)]         // ..................................................................................................................................................................e|..................................................................................................................................................................
        // ldr q5, [x5, #(-12*16 + 3*16)]         // ..........*........................................................................................................................................................|..........*.......................................................................................................................................................
        // ldr q2, [x5, #(-12*16 + 4*16)]         // ..........................................................................................*........................................................................|..........................................................................................*.......................................................................
        // ldr q6, [x5, #(-12*16 + 5*16)]         // ................................................*..................................................................................................................|................................................*.................................................................................................................
        // mul        v24.4s,  v11.4s, v0.4s      // ........................................................................................*..........................................................................|........................................................................................*.........................................................................
        // sqrdmulh v11.4s, v11.4s, v4.4s         // ......................................................................*............................................................................................|......................................................................*...........................................................................................
        // mls v24.4s, v11.4s, v8.s[0]            // ................................................................................................*..................................................................|................................................................................................*.................................................................
        // sub    v11.4s,    v9.4s, v24.4s        // ...............................................................................................................................*...................................|...............................................................................................................................*..................................
        // add    v9.4s,    v9.4s, v24.4s         // ....................................................................................................................................*..............................|....................................................................................................................................*.............................
        // mul        v24.4s,  v12.4s, v0.4s      // ...................................................................................*...............................................................................|...................................................................................*..............................................................................
        // sqrdmulh v12.4s, v12.4s, v4.4s         // ................................................................................*..................................................................................|................................................................................*.................................................................................
        // mls v24.4s, v12.4s, v8.s[0]            // ...........................................................................................*.......................................................................|...........................................................................................*......................................................................
        // sub    v12.4s,    v10.4s, v24.4s       // ......................................................................................................*............................................................|......................................................................................................*...........................................................
        // add    v10.4s,    v10.4s, v24.4s       // ....................................................................................................*..............................................................|....................................................................................................*.............................................................
        // mul        v24.4s,  v10.4s, v1.4s      // ............................................................................................................................*......................................|............................................................................................................................*.....................................
        // sqrdmulh v10.4s, v10.4s, v5.4s         // ...............................................................................................................*...................................................|...............................................................................................................*..................................................
        // mls v24.4s, v10.4s, v8.s[0]            // ..................................................................................................................................*................................|..................................................................................................................................*...............................
        // sub    v10.4s,    v9.4s, v24.4s        // .......................................................................................................................................*...........................|.......................................................................................................................................*..........................
        // add    v9.4s,    v9.4s, v24.4s         // ..........................................................................................................................................*........................|..........................................................................................................................................*.......................
        // mul        v24.4s,  v12.4s, v2.4s      // ......................................................................................................................*............................................|......................................................................................................................*...........................................
        // sqrdmulh v12.4s, v12.4s, v6.4s         // .........................................................................................................*.........................................................|.........................................................................................................*........................................................
        // mls v24.4s, v12.4s, v8.s[0]            // ................................................................................................................................*..................................|................................................................................................................................*.................................
        // sub    v12.4s,    v11.4s, v24.4s       // ......................................................................................................................................*............................|......................................................................................................................................*...........................
        // add    v11.4s,    v11.4s, v24.4s       // ........................................................................................................................................*..........................|........................................................................................................................................*.........................
        // ldr q0, [x5, #(-12*16 +  6*16)]        // ................................e..................................................................................................................................|................................e.................................................................................................................................
        // ldr q4, [x5, #(-12*16 +  7*16)]        // ................................................................e..................................................................................................|................................................................e.................................................................................................
        // ldr q1, [x5, #(-12*16 +  8*16)]        // ...............................................................................................e...................................................................|...............................................................................................e..................................................................
        // ldr q5, [x5, #(-12*16 +  9*16)]        // ..................................................................................................e................................................................|..................................................................................................e...............................................................
        // ldr q2, [x5, #(-12*16 + 10*16)]        // .....................................................................................................e.............................................................|.....................................................................................................e............................................................
        // ldr q6, [x5, #(-12*16 + 11*16)]        // .........................................................................................e.........................................................................|.........................................................................................e........................................................................
        // mul        v24.4s,  v15.4s, v0.4s      // .......................................................................................e...........................................................................|.......................................................................................e..........................................................................
        // sqrdmulh v15.4s, v15.4s, v4.4s         // .............................................................................................e.....................................................................|.............................................................................................e....................................................................
        // mls v24.4s, v15.4s, v8.s[0]            // .......................................................................................................e...........................................................|.......................................................................................................e..........................................................
        // sub    v15.4s,    v13.4s, v24.4s       // .....................................................................................................................e.............................................|.....................................................................................................................e............................................
        // add    v13.4s,    v13.4s, v24.4s       // ....................................................................................................................e..............................................|....................................................................................................................e.............................................
        // mul        v24.4s,  v16.4s, v0.4s      // .....................................................................................e.............................................................................|.....................................................................................e............................................................................
        // sqrdmulh v16.4s, v16.4s, v4.4s         // ......................................................................................e............................................................................|......................................................................................e...........................................................................
        // mls v24.4s, v16.4s, v8.s[0]            // ..............................................................................................e....................................................................|..............................................................................................e...................................................................
        // sub    v16.4s,    v14.4s, v24.4s       // ..........................................................................................................e........................................................|..........................................................................................................e.......................................................
        // add    v14.4s,    v14.4s, v24.4s       // ........................................................................................................e..........................................................|........................................................................................................e.........................................................
        // mul        v24.4s,  v14.4s, v1.4s      // ...........................................................................................................e.......................................................|...........................................................................................................e......................................................
        // sqrdmulh v14.4s, v14.4s, v5.4s         // ............................................................................................................e......................................................|............................................................................................................e.....................................................
        // mls v24.4s, v14.4s, v8.s[0]            // .................................................................................................................e.................................................|.................................................................................................................e................................................
        // sub    v14.4s,    v13.4s, v24.4s       // .......................................................................................................................e...........................................|.......................................................................................................................e..........................................
        // add    v13.4s,    v13.4s, v24.4s       // ........................................................................................................................e..........................................|........................................................................................................................e.........................................
        // mul        v24.4s,  v16.4s, v2.4s      // .............................................................................................................e.....................................................|.............................................................................................................e....................................................
        // sqrdmulh v16.4s, v16.4s, v6.4s         // ..............................................................................................................e....................................................|..............................................................................................................e...................................................
        // mls v24.4s, v16.4s, v8.s[0]            // ...................................................................................................................e...............................................|...................................................................................................................e..............................................
        // sub    v16.4s,    v15.4s, v24.4s       // .........................................................................................................................e.........................................|.........................................................................................................................e........................................
        // add    v15.4s,    v15.4s, v24.4s       // ..........................................................................................................................e........................................|..........................................................................................................................e.......................................
        // trn1 v25.4s, v9.4s, v10.4s             // .................................................................................................................................................*.................|.................................................................................................................................................*................
        // trn2 v26.4s, v9.4s, v10.4s             // ..............................................................................................................................................*....................|..............................................................................................................................................*...................
        // trn1 v27.4s, v11.4s, v12.4s            // ............................................................................................................................................*......................|............................................................................................................................................*.....................
        // trn2 v28.4s, v11.4s, v12.4s            // .............................................................................................................................................*.....................|.............................................................................................................................................*....................
        // trn2 v11.2d, v25.2d, v27.2d            // ...........................................................................................................................................................*.......|...........................................................................................................................................................*......
        // trn2 v12.2d, v26.2d, v28.2d            // ..................................................................................................................................................*................|..................................................................................................................................................*...............
        // trn1 v9.2d, v25.2d, v27.2d             // .....................................................................................................................................................*.............|.....................................................................................................................................................*............
        // trn1 v10.2d, v26.2d, v28.2d            // .......................................................................................................................................................*...........|.......................................................................................................................................................*..........
        // trn1 v25.4s, v13.4s, v14.4s            // .*.................................................................................................................................................................|.*................................................................................................................................................................
        // trn2 v26.4s, v13.4s, v14.4s            // ...........................................................................................................................e.......................................|...........................................................................................................................e......................................
        // trn1 v27.4s, v15.4s, v16.4s            // .............................................................................................................................................................e.....|.............................................................................................................................................................e....
        // trn2 v28.4s, v15.4s, v16.4s            // ..............................................................................................................................e....................................|..............................................................................................................................e...................................
        // trn2 v15.2d, v25.2d, v27.2d            // ...........*.......................................................................................................................................................|...........*......................................................................................................................................................
        // trn2 v16.2d, v26.2d, v28.2d            // ......................................................................................................................................................e............|......................................................................................................................................................e...........
        // trn1 v13.2d, v25.2d, v27.2d            // .......*...........................................................................................................................................................|.......*..........................................................................................................................................................
        // trn1 v14.2d, v26.2d, v28.2d            // .................................................................................................................................e.................................|.................................................................................................................................e................................
        // str q9, [x1], #128                     // ..........................................................................................................................................................*........|..........................................................................................................................................................*.......
        // str q10, [x1, #(-(128) + 16*1)]        // ............................................................................................................................................................*......|............................................................................................................................................................*.....
        // str q11, [x1, #(-(128) + 16*2)]        // .................................................................................................................................................................*.|.................................................................................................................................................................*
        // str q12, [x1, #(-(128) + 16*3)]        // ........................................................................................................................................................*..........|........................................................................................................................................................*.........
        // str q13, [x2], #128                    // ....................................*..............................................................................................................................|....................................*.............................................................................................................................
        // str q14, [x2, #(-(128) + 16*1)]        // ...............................................................................................................................................e...................|...............................................................................................................................................e..................
        // str q15, [x2, #(-(128) + 16*2)]        // .................*.................................................................................................................................................|.................*................................................................................................................................................
        // str q16, [x2, #(-(128) + 16*3)]        // .............*.....................................................................................................................................................|.............*....................................................................................................................................................

        sub count, count, #1
        cbnz count, layer45678_start
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        add v0.4S, v13.4S, v9.4S               // *...................................................
        sub v12.4S, v13.4S, v9.4S              // ..*.................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn2 v21.4S, v3.4S, v15.4S             // .....*..............................................
        // gap                                 // ....................................................
        str q6, [x2, #48]                      // .........*..........................................
        ldr q4, [x5], #(12*16)                 // ..............*.....................................
        trn1 v9.4S, v17.4S, v23.4S             // .*..................................................
        trn2 v17.4S, v0.4S, v12.4S             // ........*...........................................
        trn1 v6.4S, v0.4S, v12.4S              // ...........*........................................
        trn1 v29.4S, v3.4S, v15.4S             // ...*................................................
        ldr q30, [x5, #-144]                   // ......*.............................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn2 v24.2D, v17.2D, v21.2D            // .................*..................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn2 v16.2D, v6.2D, v29.2D             // ............*.......................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        mul v11.4S, v24.4S, v4.4S              // .....................*..............................
        sqrdmulh v12.4S, v24.4S, v2.4S         // ....................*...............................
        // gap                                 // ....................................................
        sqrdmulh v24.4S, v16.4S, v2.4S         // ..................*.................................
        ldr q3, [x5, #-112]                    // ...............*....................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn1 v20.2D, v17.2D, v21.2D            // ................*...................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        mls v11.4S, v12.4S, v8.S[0]            // ........................*...........................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        mul v17.4S, v16.4S, v4.4S              // ......................*.............................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn1 v16.2D, v6.2D, v29.2D             // ...................*................................
        ldr q4, [x5, #-128]                    // .......................*............................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        add v10.4S, v20.4S, v11.4S             // ..........................*.........................
        // gap                                 // ....................................................
        sub v11.4S, v20.4S, v11.4S             // ...........................*........................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        mls v17.4S, v24.4S, v8.S[0]            // .........................*..........................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        sqrdmulh v18.4S, v10.4S, v30.4S        // .............................*......................
        mul v27.4S, v10.4S, v19.4S             // ...............................*....................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        sqrdmulh v13.4S, v11.4S, v3.4S         // ............................*.......................
        mul v6.4S, v11.4S, v4.4S               // ..............................*.....................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        add v26.4S, v16.4S, v17.4S             // ...................................*................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        mls v27.4S, v18.4S, v8.S[0]            // ..................................*.................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        mls v6.4S, v13.4S, v8.S[0]             // .................................*..................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        sub v29.4S, v16.4S, v17.4S             // ................................*...................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        sub v30.4S, v26.4S, v27.4S             // .....................................*..............
        add v3.4S, v26.4S, v27.4S              // .......................................*............
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        sub v26.4S, v29.4S, v6.4S              // ....................................*...............
        add v15.4S, v29.4S, v6.4S              // ......................................*.............
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn1 v24.2D, v9.2D, v1.2D              // ....*...............................................
        trn2 v1.2D, v9.2D, v1.2D               // .......*............................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn1 v21.4S, v15.4S, v26.4S            // ........................................*...........
        trn1 v23.4S, v3.4S, v30.4S             // ...........................................*........
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn2 v26.4S, v15.4S, v26.4S            // .........................................*..........
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn2 v15.4S, v3.4S, v30.4S             // ..........................................*.........
        str q1, [x2, #32]                      // ..........*.........................................
        trn2 v29.2D, v23.2D, v21.2D            // .................................................*..
        // gap                                 // ....................................................
        str q24, [x2], #128                    // .............*......................................
        trn1 v27.2D, v23.2D, v21.2D            // .............................................*......
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        str q29, [x1, #32]                     // ...................................................*
        trn2 v16.2D, v15.2D, v26.2D            // ............................................*.......
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        trn1 v13.2D, v15.2D, v26.2D            // ..............................................*.....
        str q27, [x1], #128                    // ................................................*...
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        str q16, [x1, #-80]                    // ...............................................*....
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        str q13, [x1, #-112]                   // ..................................................*.
        // gap                                 // ....................................................
        // gap                                 // ....................................................
        // gap                                 // ....................................................

        // original source code
        // add v24.4S, v13.4S, v9.4S            // *...................................................
        // trn1 v16.4S, v17.4S, v23.4S          // .....*..............................................
        // sub v7.4S, v13.4S, v9.4S             // .*..................................................
        // trn1 v18.4S, v3.4S, v15.4S           // ........*...........................................
        // trn1 v9.2D, v16.2D, v1.2D            // ....................................*...............
        // trn2 v0.4S, v3.4S, v15.4S            // ..*.................................................
        // ldr q30, [x5, #48]                   // .........*..........................................
        // trn2 v3.2D, v16.2D, v1.2D            // .....................................*..............
        // trn2 v25.4S, v24.4S, v7.4S           // ......*.............................................
        // str q6, [x2, #48]                    // ...*................................................
        // str q3, [x2, #32]                    // ..........................................*.........
        // trn1 v17.4S, v24.4S, v7.4S           // .......*............................................
        // trn2 v1.2D, v17.2D, v18.2D           // ...........*........................................
        // str q9, [x2], #128                   // ............................................*.......
        // ldr q12, [x5], #(12*16)              // ....*...............................................
        // ldr q24, [x5, #-112]                 // ...............*....................................
        // trn1 v7.2D, v25.2D, v0.2D            // ................*...................................
        // trn2 v4.2D, v25.2D, v0.2D            // ..........*.........................................
        // sqrdmulh v0.4S, v1.4S, v2.4S         // ..............*.....................................
        // trn1 v15.2D, v17.2D, v18.2D          // ...................*................................
        // sqrdmulh v5.4S, v4.4S, v2.4S         // .............*......................................
        // mul v28.4S, v4.4S, v12.4S            // ............*.......................................
        // mul v4.4S, v1.4S, v12.4S             // ..................*.................................
        // ldr q1, [x5, #-128]                  // ....................*...............................
        // mls v28.4S, v5.4S, v8.S[0]           // .................*..................................
        // mls v4.4S, v0.4S, v8.S[0]            // .......................*............................
        // add v5.4S, v7.4S, v28.4S             // .....................*..............................
        // sub v25.4S, v7.4S, v28.4S            // ......................*.............................
        // sqrdmulh v28.4S, v25.4S, v24.4S      // ..........................*.........................
        // sqrdmulh v21.4S, v5.4S, v30.4S       // ........................*...........................
        // mul v20.4S, v25.4S, v1.4S            // ...........................*........................
        // mul v30.4S, v5.4S, v19.4S            // .........................*..........................
        // sub v14.4S, v15.4S, v4.4S            // ...............................*....................
        // mls v20.4S, v28.4S, v8.S[0]          // ..............................*.....................
        // mls v30.4S, v21.4S, v8.S[0]          // .............................*......................
        // add v28.4S, v15.4S, v4.4S            // ............................*.......................
        // sub v25.4S, v14.4S, v20.4S           // ..................................*.................
        // sub v24.4S, v28.4S, v30.4S           // ................................*...................
        // add v20.4S, v14.4S, v20.4S           // ...................................*................
        // add v0.4S, v28.4S, v30.4S            // .................................*..................
        // trn1 v14.4S, v20.4S, v25.4S          // ......................................*.............
        // trn2 v5.4S, v20.4S, v25.4S           // ........................................*...........
        // trn2 v4.4S, v0.4S, v24.4S            // .........................................*..........
        // trn1 v24.4S, v0.4S, v24.4S           // .......................................*............
        // trn2 v21.2D, v4.2D, v5.2D            // ...............................................*....
        // trn1 v31.2D, v24.2D, v14.2D          // .............................................*......
        // trn1 v0.2D, v4.2D, v5.2D             // ................................................*...
        // str q21, [x1, #48]                   // ..................................................*.
        // str q31, [x1], #128                  // .................................................*..
        // trn2 v16.2D, v24.2D, v14.2D          // ...........................................*........
        // str q0, [x1, #-112]                  // ...................................................*
        // str q16, [x1, #-96]                  // ..............................................*.....


       pop_stack
       ret